#  é—®é¢˜ç®€ä»‹

[LeetCode 105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘](https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-inorder-traversal?envType=problem-list-v2&envId=2cktkvj)

## é¢˜ç›®æè¿°

ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„ `preorder` å’Œ `inorder`ï¼Œå…¶ä¸­ `preorder` æ˜¯äºŒå‰æ ‘çš„**å…ˆåºéå†**ï¼Œ`inorder` æ˜¯åŒä¸€æ£µæ ‘çš„**ä¸­åºéå†**ï¼Œè¯·æ„é€ äºŒå‰æ ‘å¹¶è¿”å›å…¶æ ¹èŠ‚ç‚¹ã€‚

**æ³¨æ„**ï¼šä½ å¯ä»¥å‡è®¾æ ‘ä¸­æ²¡æœ‰é‡å¤çš„å…ƒç´ ã€‚

______________________________________________________________________

# ğŸ“Œ ç¤ºä¾‹è¯´æ˜

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥: preorder = [3,9,20,15,7], inorder = [9,3,15,20,7]
è¾“å‡º: [3,9,20,null,null,15,7]
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥: preorder = [-1], inorder = [-1]
è¾“å‡º: [-1]
```

> ğŸ’¡ **ç†è§£å…³é”®**ï¼š
>
> - å…ˆåºéå†ï¼šæ ¹ â†’ å·¦å­æ ‘ â†’ å³å­æ ‘
> - ä¸­åºéå†ï¼šå·¦å­æ ‘ â†’ æ ¹ â†’ å³å­æ ‘
> - åˆ©ç”¨å…ˆåºçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆæ ¹ï¼‰åœ¨ä¸­åºä¸­çš„ä½ç½®ï¼Œå¯ä»¥åˆ’åˆ†å·¦å³å­æ ‘ã€‚

______________________________________________________________________

# ğŸ’¡ è§£é¢˜æ€è·¯

## æ–¹æ³•ä¸€ï¼šé€’å½’ + å“ˆå¸Œè¡¨ä¼˜åŒ–ï¼ˆæ¨èï¼‰

### æ­¥éª¤è¯¦è§£ï¼š

1. **ç¡®å®šæ ¹èŠ‚ç‚¹**ï¼šå…ˆåºéå†çš„ç¬¬ä¸€ä¸ªå…ƒç´ å³ä¸ºå½“å‰å­æ ‘çš„æ ¹ã€‚
1. **åœ¨ä¸­åºä¸­å®šä½æ ¹**ï¼šæ‰¾åˆ°è¯¥æ ¹åœ¨ä¸­åºæ•°ç»„ä¸­çš„ç´¢å¼• `idx`ã€‚
1. **åˆ’åˆ†å·¦å³å­æ ‘**ï¼š
   - ä¸­åºä¸­ `idx` å·¦ä¾§ä¸ºå·¦å­æ ‘ï¼Œå³ä¾§ä¸ºå³å­æ ‘ã€‚
   - æ ¹æ®å·¦å­æ ‘èŠ‚ç‚¹æ•°é‡ï¼Œå¯åœ¨å…ˆåºä¸­åˆ’åˆ†å‡ºå·¦ã€å³å­æ ‘çš„èŒƒå›´ã€‚
1. **é€’å½’æ„å»ºå·¦å³å­æ ‘**ã€‚
1. **ä¼˜åŒ–æŸ¥æ‰¾**ï¼šä½¿ç”¨å“ˆå¸Œè¡¨é¢„å­˜ä¸­åºå€¼åˆ°ç´¢å¼•çš„æ˜ å°„ï¼Œé¿å…æ¯æ¬¡çº¿æ€§æŸ¥æ‰¾ã€‚

### è¾¹ç•Œå¤„ç†ï¼š

- è‹¥å­æ ‘åŒºé—´ä¸ºç©ºï¼ˆ`preStart > preEnd`ï¼‰ï¼Œè¿”å› `null`ã€‚

______________________________________________________________________

## æ–¹æ³•äºŒï¼šé€’å½’ï¼ˆæ— å“ˆå¸Œä¼˜åŒ–ï¼‰

- æ¯æ¬¡åœ¨ä¸­åºæ•°ç»„ä¸­çº¿æ€§æŸ¥æ‰¾æ ¹çš„ä½ç½®ã€‚
- æ—¶é—´å¤æ‚åº¦è¾ƒé«˜ï¼ˆO(nÂ²)ï¼‰ï¼Œä½†ä»£ç æ›´ç›´è§‚ã€‚

> âœ… **æ¨èæ–¹æ³•ä¸€**ï¼Œæ—¶é—´æ•ˆç‡æ›´é«˜ã€‚

______________________________________________________________________

# ğŸ’» ä»£ç å®ç°

<div class="code-tabs">

```java:Java
class Solution {
    private Map<Integer, Integer> inMap;
    private int[] preorder;

    public TreeNode buildTree(int[] preorder, int[] inorder) {
        this.preorder = preorder;
        inMap = new HashMap<>();
        for (int i = 0; i < inorder.length; i++) {
            inMap.put(inorder[i], i);
        }
        return build(0, 0, inorder.length - 1);
    }

    // preStart: å½“å‰å­æ ‘åœ¨preorderä¸­çš„èµ·å§‹ç´¢å¼•
    // inStart, inEnd: å½“å‰å­æ ‘åœ¨inorderä¸­çš„èŒƒå›´
    private TreeNode build(int preStart, int inStart, int inEnd) {
        if (inStart > inEnd) return null;

        int rootVal = preorder[preStart];
        TreeNode root = new TreeNode(rootVal);

        int inRoot = inMap.get(rootVal);
        int leftSize = inRoot - inStart;

        root.left = build(preStart + 1, inStart, inRoot - 1);
        root.right = build(preStart + 1 + leftSize, inRoot + 1, inEnd);

        return root;
    }
}
```

```go:Go
func buildTree(preorder []int, inorder []int) *TreeNode {
    inMap := make(map[int]int)
    for i, v := range inorder {
        inMap[v] = i
    }

    var build func(preStart, inStart, inEnd int) *TreeNode
    build = func(preStart, inStart, inEnd int) *TreeNode {
        if inStart > inEnd {
            return nil
        }

        rootVal := preorder[preStart]
        root := &TreeNode{Val: rootVal}

        inRoot := inMap[rootVal]
        leftSize := inRoot - inStart

        root.Left = build(preStart+1, inStart, inRoot-1)
        root.Right = build(preStart+1+leftSize, inRoot+1, inEnd)

        return root
    }

    return build(0, 0, len(inorder)-1)
}
```

</div>

______________________________________________________________________

# ğŸ§ª ç¤ºä¾‹æ¼”ç¤ºï¼ˆä»¥ç¤ºä¾‹1ä¸ºä¾‹ï¼‰

```
preorder = [3,9,20,15,7]
inorder  = [9,3,15,20,7]
```

1. **æ ¹ = 3**ï¼ˆpre[0]ï¼‰

   - inä¸­ä½ç½® idx=1
   - å·¦å­æ ‘ä¸­åºï¼š[9] â†’ size=1
   - å·¦å­æ ‘å…ˆåºï¼š[9]ï¼ˆpre[1:1+1]ï¼‰
   - å³å­æ ‘å…ˆåºï¼š[20,15,7]ï¼ˆpre[2:]ï¼‰

1. **å·¦å­æ ‘**ï¼š

   - æ ¹=9ï¼Œä¸­åº=[9] â†’ æ— å·¦å³å­æ ‘

1. **å³å­æ ‘**ï¼š

   - æ ¹=20ï¼ˆpre[2]ï¼‰
   - inä¸­ä½ç½® idx=3ï¼ˆå…¨å±€ï¼‰ï¼Œå±€éƒ¨ in=[15,20,7] â†’ idx=1
   - å·¦ï¼š[15]ï¼Œå³ï¼š[7]

æœ€ç»ˆæ„å»ºå‡ºæ­£ç¡®äºŒå‰æ ‘ã€‚

______________________________________________________________________

# âœ… ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

- **å”¯ä¸€æ€§**ï¼šé¢˜ç›®ä¿è¯æ— é‡å¤å…ƒç´  â‡’ ä¸­åºä¸­æ ¹ä½ç½®å”¯ä¸€ â‡’ å­æ ‘åˆ’åˆ†å”¯ä¸€ã€‚
- **é€’å½’æ­£ç¡®æ€§**ï¼š
  - åŸºç¡€æƒ…å†µï¼šç©ºåŒºé—´è¿”å› `null`ã€‚
  - å½’çº³æ­¥éª¤ï¼šæ¯æ¬¡æ­£ç¡®åˆ’åˆ†å·¦å³å­æ ‘ï¼Œå¹¶é€’å½’æ„å»ºã€‚
- **éå†ä¸€è‡´æ€§**ï¼š
  - æ„å»ºçš„æ ‘è‹¥è¿›è¡Œå…ˆåº/ä¸­åºéå†ï¼Œå¿…ä¸è¾“å…¥ä¸€è‡´ï¼ˆç”±æ„é€ è¿‡ç¨‹ä¿è¯ï¼‰ã€‚

______________________________________________________________________

# ğŸ“Š å¤æ‚åº¦åˆ†æ

| é¡¹ç›® | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ |
|------|-----------|-----------|
| æ–¹æ³•ä¸€ï¼ˆå“ˆå¸Œä¼˜åŒ–ï¼‰ | O(n) | O(n)ï¼ˆå“ˆå¸Œè¡¨ + é€’å½’æ ˆï¼‰ |
| æ–¹æ³•äºŒï¼ˆæ— ä¼˜åŒ–ï¼‰ | O(nÂ²) | O(n)ï¼ˆä»…é€’å½’æ ˆï¼‰ |

> - **n** ä¸ºèŠ‚ç‚¹æ•°é‡ã€‚
> - å“ˆå¸Œè¡¨ä½¿æ¯æ¬¡æŸ¥æ‰¾æ ¹ä½ç½®ä¸º O(1)ï¼Œæ€»æ—¶é—´ O(n)ã€‚
> - é€’å½’æ·±åº¦æœ€å O(n)ï¼ˆé“¾çŠ¶æ ‘ï¼‰ï¼Œå¹³å‡ O(log n)ã€‚

______________________________________________________________________

# ğŸ“Œ é—®é¢˜æ€»ç»“

- **æ ¸å¿ƒæ€æƒ³**ï¼šåˆ©ç”¨å…ˆåºç¡®å®šæ ¹ï¼Œä¸­åºåˆ’åˆ†å·¦å³å­æ ‘ã€‚
- **å…³é”®æŠ€å·§**ï¼šå“ˆå¸Œè¡¨åŠ é€Ÿä¸­åºç´¢å¼•æŸ¥æ‰¾ã€‚
- **é€‚ç”¨åœºæ™¯**ï¼šå·²çŸ¥ä¸¤ç§éå†åºåˆ—ï¼ˆå¿…é¡»åŒ…å«ä¸­åºï¼‰å¯å”¯ä¸€ç¡®å®šäºŒå‰æ ‘ã€‚
- **æ‰©å±•æ€è€ƒ**ï¼š
  - è‹¥ç»™å®š**ååº+ä¸­åº**ï¼ŒåŒæ ·å¯æ„é€ ï¼ˆååºæœ€åä¸€ä¸ªä¸ºæ ¹ï¼‰ã€‚
  - è‹¥åªæœ‰å…ˆåº+ååºï¼Œ**æ— æ³•å”¯ä¸€ç¡®å®š**ï¼ˆé™¤éæ˜¯æ»¡äºŒå‰æ ‘ï¼‰ã€‚

> ğŸ’¡ **è®°å¿†å£è¯€**ï¼š\
> â€œå…ˆåºæ‰¾æ ¹ï¼Œä¸­åºåˆ†å®¶ï¼›é€’å½’æ„å»ºï¼Œå“ˆå¸ŒåŠ é€Ÿã€‚â€
