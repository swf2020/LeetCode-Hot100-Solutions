# é—®é¢˜ç®€ä»‹

[LeetCode 114. äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨](https://leetcode.cn/problems/flatten-binary-tree-to-linked-list?envType=problem-list-v2&envId=2cktkvj)

## é¢˜ç›®æè¿°

ç»™ä½ äºŒå‰æ ‘çš„æ ¹ç»“ç‚¹ `root`ï¼Œè¯·ä½ å°†å®ƒå±•å¼€ä¸ºä¸€ä¸ªå•é“¾è¡¨ï¼š

- å±•å¼€åçš„å•é“¾è¡¨åº”è¯¥åŒæ ·ä½¿ç”¨ `TreeNode`ï¼Œå…¶ä¸­ `right` å­æŒ‡é’ˆæŒ‡å‘é“¾è¡¨ä¸­ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œå·¦å­æŒ‡é’ˆå§‹ç»ˆä¸º `null`ã€‚
- å±•å¼€åçš„å•é“¾è¡¨åº”è¯¥ä¸äºŒå‰æ ‘ **å…ˆåºéå†** é¡ºåºç›¸åŒã€‚

## ç¤ºä¾‹è¯´æ˜

### ç¤ºä¾‹ 1ï¼š

```
è¾“å…¥ï¼šroot = [1,2,5,3,4,null,6]
è¾“å‡ºï¼š[1,null,2,null,3,null,4,null,5,null,6]
```

### ç¤ºä¾‹ 2ï¼š

```
è¾“å…¥ï¼šroot = []
è¾“å‡ºï¼š[]
```

### ç¤ºä¾‹ 3ï¼š

```
è¾“å…¥ï¼šroot = [0]
è¾“å‡ºï¼š[0]
```

ğŸ“Œ **å›¾ç¤ºè¯´æ˜**ï¼ˆä»¥ç¤ºä¾‹1ä¸ºä¾‹ï¼‰ï¼š

åŸå§‹äºŒå‰æ ‘ï¼š

```
    1
   / \
  2   5
 / \   \
3   4   6
```

å±•å¼€åé“¾è¡¨ï¼ˆåªçœ‹ right æŒ‡é’ˆï¼‰ï¼š

```
1 â†’ 2 â†’ 3 â†’ 4 â†’ 5 â†’ 6
```

______________________________________________________________________

# è§£é¢˜æ€è·¯

## âœ… æ–¹æ³•ä¸€ï¼šé€’å½’ + å…ˆåºéå†ï¼ˆååºå¤„ç†ï¼‰

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼š\
æˆ‘ä»¬å¸Œæœ›æŒ‰ç…§å…ˆåºéå†çš„é¡ºåºé‡æ–°ç»„ç»‡èŠ‚ç‚¹ã€‚ä½†å¦‚æœæˆ‘ä»¬ç›´æ¥åœ¨éå†æ—¶ä¿®æ”¹æŒ‡é’ˆï¼Œä¼šä¸¢å¤±å­æ ‘ä¿¡æ¯ã€‚å› æ­¤é‡‡ç”¨**ååºéå†çš„æ–¹å¼**ï¼Œä»ä¸‹å¾€ä¸Šå¤„ç†ã€‚

**æ­¥éª¤**ï¼š

1. é€’å½’å±•å¼€å·¦å­æ ‘å’Œå³å­æ ‘ã€‚
1. å°†å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘æš‚å­˜ã€‚
1. å°†å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘è®¾ä¸ºå·¦å­æ ‘ï¼ˆæ­¤æ—¶å·¦å­æ ‘å·²å±•å¼€ä¸ºé“¾è¡¨ï¼‰ã€‚
1. å°†å·¦å­æ ‘ç½®ç©ºã€‚
1. æ‰¾åˆ°å½“å‰å³å­æ ‘ï¼ˆåŸå·¦å­æ ‘ï¼‰çš„æœ€å³èŠ‚ç‚¹ï¼Œå°†å…¶ `right` æŒ‡å‘æš‚å­˜çš„åŸå³å­æ ‘ã€‚

> è¿™ç§æ–¹æ³•ä¿è¯äº†åœ¨å¤„ç†å½“å‰èŠ‚ç‚¹æ—¶ï¼Œå·¦å³å­æ ‘å·²ç»å„è‡ªè¢«å±•å¹³ä¸ºé“¾è¡¨ã€‚

______________________________________________________________________

## âœ… æ–¹æ³•äºŒï¼šè¿­ä»£ï¼ˆä½¿ç”¨æ ˆæ¨¡æ‹Ÿå…ˆåºéå†ï¼‰

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼š\
ç”¨æ ˆæ¨¡æ‹Ÿå…ˆåºéå†ï¼ŒåŒæ—¶åœ¨éå†è¿‡ç¨‹ä¸­è°ƒæ•´æŒ‡é’ˆã€‚

**æ­¥éª¤**ï¼š

1. ä½¿ç”¨æ ˆå­˜å‚¨å¾…è®¿é—®èŠ‚ç‚¹ã€‚
1. æ¯æ¬¡å¼¹å‡ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†å…¶å³ã€å·¦å­èŠ‚ç‚¹ä¾æ¬¡å‹å…¥æ ˆï¼ˆå› ä¸ºæ ˆæ˜¯ LIFOï¼Œæ‰€ä»¥å…ˆå‹å³å†å‹å·¦ï¼Œä¿è¯å…ˆè®¿é—®å·¦ï¼‰ã€‚
1. åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå°†å‰ä¸€ä¸ªèŠ‚ç‚¹çš„ `right` æŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œå¹¶å°† `left` ç½®ç©ºã€‚

> æ³¨æ„ï¼šéœ€è¦è®°å½•å‰ä¸€ä¸ªè®¿é—®çš„èŠ‚ç‚¹ã€‚

______________________________________________________________________

## âœ… æ–¹æ³•ä¸‰ï¼šMorris éå†ï¼ˆç©ºé—´å¤æ‚åº¦ O(1)ï¼‰

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼š\
åˆ©ç”¨ Morris å…ˆåºéå†çš„æ€æƒ³ï¼Œåœ¨ä¸ä½¿ç”¨é¢å¤–ç©ºé—´çš„æƒ…å†µä¸‹å®Œæˆå±•å¼€ã€‚

**å…³é”®è§‚å¯Ÿ**ï¼š\
åœ¨å…ˆåºéå†ä¸­ï¼Œå·¦å­æ ‘çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå³å·¦å­æ ‘æœ€å³èŠ‚ç‚¹ï¼‰çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ã€‚

**æ­¥éª¤**ï¼š

1. å¯¹äºå½“å‰èŠ‚ç‚¹ï¼š
   - å¦‚æœæœ‰å·¦å­æ ‘ï¼š
     - æ‰¾åˆ°å·¦å­æ ‘çš„æœ€å³èŠ‚ç‚¹ï¼ˆå‰é©±èŠ‚ç‚¹ï¼‰ã€‚
     - å°†å‰é©±èŠ‚ç‚¹çš„ `right` æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘ã€‚
     - å°†å½“å‰èŠ‚ç‚¹çš„ `right` æŒ‡å‘å·¦å­æ ‘ã€‚
     - å°†å½“å‰èŠ‚ç‚¹çš„ `left` ç½®ç©ºã€‚
   - ç§»åŠ¨åˆ° `right` èŠ‚ç‚¹ç»§ç»­å¤„ç†ã€‚

> è¿™æ˜¯æœ€ä¼˜è§£ï¼Œæ—¶é—´ O(n)ï¼Œç©ºé—´ O(1)ã€‚

______________________________________________________________________

# ä»£ç å®ç°

```java
// Java å®ç°
/**
 * Definition for a binary tree node.
 * public class TreeNode {
 *     int val;
 *     TreeNode left;
 *     TreeNode right;
 *     TreeNode() {}
 *     TreeNode(int val) { this.val = val; }
 *     TreeNode(int val, TreeNode left, TreeNode right) {
 *         this.val = val;
 *         this.left = left;
 *         this.right = right;
 *     }
 * }
 */

// æ–¹æ³•ä¸€ï¼šé€’å½’ï¼ˆååºï¼‰
class Solution {
    public void flatten(TreeNode root) {
        if (root == null) return;
        
        // é€’å½’å±•å¼€å·¦å³å­æ ‘
        flatten(root.left);
        flatten(root.right);
        
        // ä¿å­˜å³å­æ ‘
        TreeNode right = root.right;
        
        // å°†å·¦å­æ ‘ç§»åˆ°å³è¾¹
        root.right = root.left;
        root.left = null;
        
        // æ‰¾åˆ°å½“å‰å³å­æ ‘çš„æœ€å³èŠ‚ç‚¹
        TreeNode curr = root;
        while (curr.right != null) {
            curr = curr.right;
        }
        
        // è¿æ¥åŸå³å­æ ‘
        curr.right = right;
    }
}

// æ–¹æ³•äºŒï¼šè¿­ä»£ï¼ˆæ ˆï¼‰
class Solution2 {
    public void flatten(TreeNode root) {
        if (root == null) return;
        
        Stack<TreeNode> stack = new Stack<>();
        stack.push(root);
        TreeNode prev = null;
        
        while (!stack.isEmpty()) {
            TreeNode curr = stack.pop();
            
            if (prev != null) {
                prev.right = curr;
                prev.left = null;
            }
            
            // å…ˆå‹å³ï¼Œå†å‹å·¦ï¼ˆä¿è¯å…ˆå¤„ç†å·¦ï¼‰
            if (curr.right != null) {
                stack.push(curr.right);
            }
            if (curr.left != null) {
                stack.push(curr.left);
            }
            
            prev = curr;
        }
    }
}

// æ–¹æ³•ä¸‰ï¼šMorris éå†ï¼ˆO(1) ç©ºé—´ï¼‰
class Solution3 {
    public void flatten(TreeNode root) {
        TreeNode curr = root;
        
        while (curr != null) {
            if (curr.left != null) {
                // æ‰¾åˆ°å·¦å­æ ‘çš„æœ€å³èŠ‚ç‚¹
                TreeNode predecessor = curr.left;
                while (predecessor.right != null) {
                    predecessor = predecessor.right;
                }
                
                // å°†åŸå³å­æ ‘æ¥åˆ°å‰é©±èŠ‚ç‚¹åé¢
                predecessor.right = curr.right;
                
                // å·¦å­æ ‘ç§»åˆ°å³è¾¹
                curr.right = curr.left;
                curr.left = null;
            }
            
            curr = curr.right;
        }
    }
}
````

```go
// Go å®ç°

/**
 * Definition for a binary tree node.
 * type TreeNode struct {
 *     Val int
 *     Left *TreeNode
 *     Right *TreeNode
 * }
 */

// æ–¹æ³•ä¸€ï¼šé€’å½’ï¼ˆååºï¼‰
func flatten(root *TreeNode) {
    if root == nil {
        return
    }
    
    // é€’å½’å±•å¼€å·¦å³å­æ ‘
    flatten(root.Left)
    flatten(root.Right)
    
    // ä¿å­˜å³å­æ ‘
    right := root.Right
    
    // å°†å·¦å­æ ‘ç§»åˆ°å³è¾¹
    root.Right = root.Left
    root.Left = nil
    
    // æ‰¾åˆ°å½“å‰å³å­æ ‘çš„æœ€å³èŠ‚ç‚¹
    curr := root
    for curr.Right != nil {
        curr = curr.Right
    }
    
    // è¿æ¥åŸå³å­æ ‘
    curr.Right = right
}

// æ–¹æ³•äºŒï¼šè¿­ä»£ï¼ˆæ ˆï¼‰
func flatten2(root *TreeNode) {
    if root == nil {
        return
    }
    
    stack := []*TreeNode{root}
    var prev *TreeNode
    
    for len(stack) > 0 {
        curr := stack[len(stack)-1]
        stack = stack[:len(stack)-1]
        
        if prev != nil {
            prev.Right = curr
            prev.Left = nil
        }
        
        // å…ˆå‹å³ï¼Œå†å‹å·¦
        if curr.Right != nil {
            stack = append(stack, curr.Right)
        }
        if curr.Left != nil {
            stack = append(stack, curr.Left)
        }
        
        prev = curr
    }
}

// æ–¹æ³•ä¸‰ï¼šMorris éå†ï¼ˆO(1) ç©ºé—´ï¼‰
func flatten3(root *TreeNode) {
    curr := root
    
    for curr != nil {
        if curr.Left != nil {
            // æ‰¾åˆ°å·¦å­æ ‘çš„æœ€å³èŠ‚ç‚¹
            predecessor := curr.Left
            for predecessor.Right != nil {
                predecessor = predecessor.Right
            }
            
            // å°†åŸå³å­æ ‘æ¥åˆ°å‰é©±èŠ‚ç‚¹åé¢
            predecessor.Right = curr.Right
            
            // å·¦å­æ ‘ç§»åˆ°å³è¾¹
            curr.Right = curr.Left
            curr.Left = nil
        }
        
        curr = curr.Right
    }
}
```

---

# ç¤ºä¾‹æ¼”ç¤º

ä»¥ `root = [1,2,5,3,4,null,6]` ä¸ºä¾‹ï¼Œå±•ç¤º **æ–¹æ³•ä¸€ï¼ˆé€’å½’ï¼‰** çš„æ‰§è¡Œè¿‡ç¨‹ï¼š

```

åˆå§‹ï¼š
1
/ \
2 5
/ \\ \
3 4 6

é€’å½’è°ƒç”¨ flatten(2):
flatten(3) â†’ å¶å­ï¼Œä¸å˜
flatten(4) â†’ å¶å­ï¼Œä¸å˜
å¤„ç† 2:
right = nullï¼ˆåŸ2çš„å³å­æ ‘æ˜¯4ï¼Œä½†flatten(4)å4çš„right=nullï¼‰
2.right = 3ï¼ˆåŸå·¦å­æ ‘ï¼‰
2.left = null
æ‰¾åˆ° 3 çš„æœ€å³ï¼ˆå°±æ˜¯3ï¼‰ï¼Œ3.right = 4
â†’ 2 â†’ 3 â†’ 4

é€’å½’è°ƒç”¨ flatten(5):
flatten(null)
flatten(6)
å¤„ç† 5:
5.right = nullï¼ˆæ— å·¦å­æ ‘ï¼‰
â†’ 5 â†’ 6

å›åˆ° root=1:
right = 5â†’6
1.right = 2â†’3â†’4
1.left = null
æ‰¾åˆ° 4ï¼ˆæœ€å³ï¼‰ï¼Œ4.right = 5â†’6
æœ€ç»ˆï¼š1â†’2â†’3â†’4â†’5â†’6

```

âœ… **ç»“æœæ­£ç¡®ï¼**

---

# ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

æˆ‘ä»¬éœ€è¯æ˜ï¼š**æœ€ç»ˆé“¾è¡¨çš„é¡ºåºç­‰äºåŸæ ‘çš„å…ˆåºéå†åºåˆ—**ã€‚

- **æ–¹æ³•ä¸€ï¼ˆé€’å½’ï¼‰**ï¼š  
  ç”±äºæˆ‘ä»¬å…ˆé€’å½’å¤„ç†å·¦å³å­æ ‘ï¼ˆä½¿å…¶å˜ä¸ºå…ˆåºé“¾è¡¨ï¼‰ï¼Œå†å°†â€œå·¦é“¾è¡¨â€æ¥åœ¨æ ¹åï¼Œâ€œå³é“¾è¡¨â€æ¥åœ¨å·¦é“¾è¡¨åï¼Œæ•´ä½“é¡ºåºä¸º `[root] + [left preorder] + [right preorder]`ï¼Œç¬¦åˆå…ˆåºå®šä¹‰ã€‚

- **æ–¹æ³•äºŒï¼ˆè¿­ä»£ï¼‰**ï¼š  
  æ ˆæ¨¡æ‹Ÿçš„å°±æ˜¯æ ‡å‡†å…ˆåºéå†ï¼ˆæ ¹â†’å·¦â†’å³ï¼‰ï¼Œä¸”æ¯æ¬¡å°†å‰ä¸€ä¸ªèŠ‚ç‚¹çš„ `right` æŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œå› æ­¤é¡ºåºä¸€è‡´ã€‚

- **æ–¹æ³•ä¸‰ï¼ˆMorrisï¼‰**ï¼š  
  Morris å…ˆåºéå†æœ¬èº«å°±èƒ½ä¿è¯è®¿é—®é¡ºåºæ­£ç¡®ï¼Œè€Œæˆ‘ä»¬åœ¨è®¿é—®æ¯ä¸ªèŠ‚ç‚¹æ—¶ç«‹å³è°ƒæ•´æŒ‡é’ˆï¼Œç¡®ä¿ç»“æ„åŒæ­¥æ›´æ–°ã€‚

å› æ­¤ï¼Œä¸‰ç§æ–¹æ³•å‡èƒ½æ­£ç¡®ç”Ÿæˆå…ˆåºé“¾è¡¨ã€‚

---

# å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | è¯´æ˜ |
|------|-----------|-----------|------|
| é€’å½’ | O(n) | O(n) | é€’å½’æ ˆæ·±åº¦æœ€åä¸º nï¼ˆé€€åŒ–ä¸ºé“¾è¡¨ï¼‰ |
| è¿­ä»£ï¼ˆæ ˆï¼‰ | O(n) | O(n) | æ ˆæœ€å¤šå­˜å‚¨ n ä¸ªèŠ‚ç‚¹ |
| Morris éå† | O(n) | **O(1)** | åˆ©ç”¨æ ‘æœ¬èº«ç»“æ„ï¼Œæ— éœ€é¢å¤–ç©ºé—´ |

> âš ï¸ æ³¨æ„ï¼šè™½ç„¶ Morris æ–¹æ³•ç©ºé—´æœ€ä¼˜ï¼Œä½†ä¼š**ä¸´æ—¶ä¿®æ”¹æ ‘ç»“æ„**ï¼ˆä¸è¿‡æœ€ç»ˆæ¢å¤ä¸ºé“¾è¡¨ï¼Œç¬¦åˆé¢˜ç›®è¦æ±‚ï¼‰ã€‚

---

# é—®é¢˜æ€»ç»“

- âŒ **å¸¸è§é”™è¯¯**ï¼šåœ¨å…ˆåºéå†è¿‡ç¨‹ä¸­ç›´æ¥ä¿®æ”¹æŒ‡é’ˆï¼Œå¯¼è‡´å­æ ‘ä¸¢å¤±ã€‚
- âœ… **å…³é”®æ´å¯Ÿ**ï¼šå¿…é¡»åœ¨å¤„ç†å½“å‰èŠ‚ç‚¹å‰ï¼Œç¡®ä¿å·¦å³å­æ ‘å·²å±•å¹³ï¼›æˆ–ä½¿ç”¨ Morris æŠ€å·§é¿å…ä¿¡æ¯ä¸¢å¤±ã€‚
- ğŸ’¡ **æœ€ä¼˜è§£**ï¼š**Morris éå†**ï¼Œç©ºé—´å¤æ‚åº¦ O(1)ï¼Œé€‚åˆé¢è¯•å±•ç¤ºé«˜çº§æŠ€å·§ã€‚
- ğŸ“Œ **é€‚ç”¨åœºæ™¯**ï¼š
  - é€’å½’ï¼šä»£ç ç®€æ´ï¼Œé€‚åˆç†è§£é€»è¾‘ã€‚
  - è¿­ä»£ï¼šé¿å…é€’å½’æ ˆæº¢å‡ºï¼ˆå¯¹ææ·±æ ‘æ›´å®‰å…¨ï¼‰ã€‚
  - Morrisï¼šè¿½æ±‚æè‡´ç©ºé—´æ•ˆç‡ã€‚

> æœ¬é¢˜æ˜¯**æ ‘ç»“æ„åŸåœ°è½¬æ¢**çš„ç»å…¸é—®é¢˜ï¼ŒæŒæ¡å…¶æ€æƒ³æœ‰åŠ©äºè§£å†³ç±»ä¼¼â€œå±•å¼€â€ã€â€œæ‹‰ç›´â€ç±»é¢˜ç›®ã€‚
