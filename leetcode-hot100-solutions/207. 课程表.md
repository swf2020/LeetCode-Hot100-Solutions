# é—®é¢˜ç®€ä»‹

[207. è¯¾ç¨‹è¡¨ - LeetCode](https://leetcode.cn/problems/course-schedule?envType=problem-list-v2&envId=2cktkvj)

## é¢˜ç›®æè¿°

ä½ è¿™ä¸ªå­¦æœŸå¿…é¡»é€‰ä¿® `numCourses` é—¨è¯¾ç¨‹ï¼Œè®°ä¸º `0` åˆ° `numCourses - 1`ã€‚

åœ¨é€‰ä¿®æŸäº›è¯¾ç¨‹ä¹‹å‰éœ€è¦ä¸€äº›å…ˆä¿®è¯¾ç¨‹ã€‚å…ˆä¿®è¯¾ç¨‹æŒ‰æ•°ç»„ `prerequisites` ç»™å‡ºï¼Œå…¶ä¸­ `prerequisites[i] = [ai, bi]` ï¼Œè¡¨ç¤ºå¦‚æœè¦å­¦ä¹ è¯¾ç¨‹ `ai` åˆ™ **å¿…é¡»** å…ˆå­¦ä¹ è¯¾ç¨‹ `bi`ã€‚

- ä¾‹å¦‚ï¼Œå…ˆä¿®è¯¾ç¨‹å¯¹ `[0, 1]` è¡¨ç¤ºï¼šæƒ³è¦å­¦ä¹ è¯¾ç¨‹ `0`ï¼Œä½ éœ€è¦å…ˆå®Œæˆè¯¾ç¨‹ `1`ã€‚

è¯·ä½ åˆ¤æ–­æ˜¯å¦å¯èƒ½å®Œæˆæ‰€æœ‰è¯¾ç¨‹çš„å­¦ä¹ ï¼Ÿå¦‚æœå¯ä»¥ï¼Œè¿”å› `true`ï¼›å¦åˆ™ï¼Œè¿”å› `false`ã€‚

______________________________________________________________________

# ç¤ºä¾‹è¯´æ˜

âœ… **ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šnumCourses = 2, prerequisites = [[1,0]]
è¾“å‡ºï¼štrue
è§£é‡Šï¼šæ€»å…±æœ‰ 2 é—¨è¯¾ç¨‹ã€‚å­¦ä¹ è¯¾ç¨‹ 1 ä¹‹å‰ï¼Œä½ éœ€è¦å®Œæˆè¯¾ç¨‹ 0ã€‚è¿™æ˜¯å¯èƒ½çš„ã€‚
```

âœ… **ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šnumCourses = 2, prerequisites = [[1,0],[0,1]]
è¾“å‡ºï¼šfalse
è§£é‡Šï¼šæ€»å…±æœ‰ 2 é—¨è¯¾ç¨‹ã€‚å­¦ä¹ è¯¾ç¨‹ 1 ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆå®Œæˆè¯¾ç¨‹ 0ï¼›å¹¶ä¸”å­¦ä¹ è¯¾ç¨‹ 0 ä¹‹å‰ï¼Œä½ è¿˜åº”å…ˆå®Œæˆè¯¾ç¨‹ 1ã€‚è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚
```

ğŸ“Œ **æç¤ºï¼š**

- `1 <= numCourses <= 2000`
- `0 <= prerequisites.length <= 5000`
- `prerequisites[i].length == 2`
- `0 <= ai, bi < numCourses`
- `ai != bi`
- æ‰€æœ‰ `[ai, bi]` äº’ä¸ç›¸åŒ

______________________________________________________________________

# è§£é¢˜æ€è·¯

æœ¬é¢˜æœ¬è´¨ä¸Šæ˜¯**åˆ¤æ–­æœ‰å‘å›¾ä¸­æ˜¯å¦å­˜åœ¨ç¯**ã€‚å¦‚æœå­˜åœ¨ç¯ï¼Œåˆ™æ— æ³•å®Œæˆæ‰€æœ‰è¯¾ç¨‹ï¼ˆå› ä¸ºä¼šå‡ºç°å¾ªç¯ä¾èµ–ï¼‰ï¼›å¦åˆ™å¯ä»¥å®Œæˆã€‚

æˆ‘ä»¬å¯ä»¥å°†è¯¾ç¨‹çœ‹ä½œå›¾ä¸­çš„èŠ‚ç‚¹ï¼Œå…ˆä¿®å…³ç³»çœ‹ä½œæœ‰å‘è¾¹ï¼ˆ`bi â†’ ai` è¡¨ç¤º `bi` æ˜¯ `ai` çš„å…ˆä¿®è¯¾ï¼‰ã€‚é—®é¢˜è½¬åŒ–ä¸ºï¼š**åˆ¤æ–­è¯¥æœ‰å‘å›¾æ˜¯å¦ä¸ºæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰**ã€‚

## æ–¹æ³•ä¸€ï¼šæ‹“æ‰‘æ’åºï¼ˆKahn ç®—æ³•ï¼‰

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼šåˆ©ç”¨å…¥åº¦è¿›è¡Œ BFS æ‹“æ‰‘æ’åºã€‚

1. æ„å»ºé‚»æ¥è¡¨å’Œå…¥åº¦æ•°ç»„ã€‚
1. å°†æ‰€æœ‰å…¥åº¦ä¸º 0 çš„è¯¾ç¨‹åŠ å…¥é˜Ÿåˆ—ã€‚
1. ä¾æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºè¯¾ç¨‹ï¼Œå°†å…¶æŒ‡å‘çš„è¯¾ç¨‹å…¥åº¦å‡ 1ï¼›è‹¥æŸè¯¾ç¨‹å…¥åº¦å˜ä¸º 0ï¼Œåˆ™åŠ å…¥é˜Ÿåˆ—ã€‚
1. æœ€ç»ˆè‹¥å¤„ç†çš„è¯¾ç¨‹æ•°ç­‰äº `numCourses`ï¼Œè¯´æ˜æ— ç¯ï¼Œè¿”å› `true`ï¼›å¦åˆ™å­˜åœ¨ç¯ï¼Œè¿”å› `false`ã€‚

âœ… **ä¼˜ç‚¹**ï¼šç›´è§‚ã€æ˜“äºç†è§£ï¼ŒåŒæ—¶å¯è¾“å‡ºæ‹“æ‰‘åºåˆ—ã€‚

## æ–¹æ³•äºŒï¼šDFS + ä¸‰è‰²æ ‡è®°æ³•

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼šé€šè¿‡ DFS éå†æ£€æµ‹å›è¾¹ï¼ˆback edgeï¼‰ã€‚

ä½¿ç”¨ä¸‰ç§çŠ¶æ€æ ‡è®°èŠ‚ç‚¹ï¼š

- **0ï¼ˆæœªè®¿é—®ï¼‰**ï¼šå°šæœªè®¿é—®è¯¥èŠ‚ç‚¹ã€‚
- **1ï¼ˆæ­£åœ¨è®¿é—®ï¼‰**ï¼šå½“å‰ DFS è·¯å¾„ä¸­æ­£åœ¨è®¿é—®è¯¥èŠ‚ç‚¹ï¼ˆå³åœ¨é€’å½’æ ˆä¸­ï¼‰ã€‚
- **2ï¼ˆå·²å®Œæˆï¼‰**ï¼šè¯¥èŠ‚ç‚¹åŠå…¶æ‰€æœ‰åç»§å·²è®¿é—®å®Œæ¯•ï¼Œæ— ç¯ã€‚

è‹¥åœ¨ DFS è¿‡ç¨‹ä¸­é‡åˆ°çŠ¶æ€ä¸º 1 çš„èŠ‚ç‚¹ï¼Œè¯´æ˜å­˜åœ¨ç¯ã€‚

âœ… **ä¼˜ç‚¹**ï¼šç©ºé—´æ•ˆç‡ç•¥é«˜ï¼Œé€‚åˆç¨€ç–å›¾ã€‚

______________________________________________________________________

# ä»£ç å®ç°

```java
// Java å®ç°

// æ–¹æ³•ä¸€ï¼šæ‹“æ‰‘æ’åºï¼ˆKahn ç®—æ³•ï¼‰
class Solution {
    public boolean canFinish(int numCourses, int[][] prerequisites) {
        // æ„å»ºé‚»æ¥è¡¨å’Œå…¥åº¦æ•°ç»„
        List<List<Integer>> graph = new ArrayList<>();
        int[] indegree = new int[numCourses];
        
        for (int i = 0; i < numCourses; i++) {
            graph.add(new ArrayList<>());
        }
        
        for (int[] pre : prerequisites) {
            int from = pre[1], to = pre[0];
            graph.get(from).add(to);
            indegree[to]++;
        }
        
        // BFS
        Queue<Integer> queue = new LinkedList<>();
        for (int i = 0; i < numCourses; i++) {
            if (indegree[i] == 0) {
                queue.offer(i);
            }
        }
        
        int visited = 0;
        while (!queue.isEmpty()) {
            int course = queue.poll();
            visited++;
            for (int next : graph.get(course)) {
                indegree[next]--;
                if (indegree[next] == 0) {
                    queue.offer(next);
                }
            }
        }
        
        return visited == numCourses;
    }
}

// æ–¹æ³•äºŒï¼šDFS + ä¸‰è‰²æ ‡è®°
class Solution {
    public boolean canFinish(int numCourses, int[][] prerequisites) {
        List<List<Integer>> graph = new ArrayList<>();
        for (int i = 0; i < numCourses; i++) {
            graph.add(new ArrayList<>());
        }
        for (int[] pre : prerequisites) {
            graph.get(pre[1]).add(pre[0]);
        }
        
        int[] color = new int[numCourses]; // 0: unvisited, 1: visiting, 2: visited
        
        for (int i = 0; i < numCourses; i++) {
            if (color[i] == 0 && hasCycle(graph, color, i)) {
                return false;
            }
        }
        return true;
    }
    
    private boolean hasCycle(List<List<Integer>> graph, int[] color, int node) {
        if (color[node] == 1) return true; // å‘ç°ç¯
        if (color[node] == 2) return false; // å·²å®Œæˆï¼Œæ— ç¯
        
        color[node] = 1;
        for (int neighbor : graph.get(node)) {
            if (hasCycle(graph, color, neighbor)) {
                return true;
            }
        }
        color[node] = 2;
        return false;
    }
}
```

```go
// Go å®ç°

// æ–¹æ³•ä¸€ï¼šæ‹“æ‰‘æ’åºï¼ˆKahn ç®—æ³•ï¼‰
func canFinish(numCourses int, prerequisites [][]int) bool {
    graph := make([][]int, numCourses)
    indegree := make([]int, numCourses)
    
    for _, pre := range prerequisites {
        from, to := pre[1], pre[0]
        graph[from] = append(graph[from], to)
        indegree[to]++
    }
    
    queue := []int{}
    for i := 0; i < numCourses; i++ {
        if indegree[i] == 0 {
            queue = append(queue, i)
        }
    }
    
    visited := 0
    for len(queue) > 0 {
        course := queue[0]
        queue = queue[1:]
        visited++
        for _, next := range graph[course] {
            indegree[next]--
            if indegree[next] == 0 {
                queue = append(queue, next)
            }
        }
    }
    
    return visited == numCourses
}

// æ–¹æ³•äºŒï¼šDFS + ä¸‰è‰²æ ‡è®°
func canFinish(numCourses int, prerequisites [][]int) bool {
    graph := make([][]int, numCourses)
    for _, pre := range prerequisites {
        graph[pre[1]] = append(graph[pre[1]], pre[0])
    }
    
    color := make([]int, numCourses) // 0: unvisited, 1: visiting, 2: visited
    
    var hasCycle func(int) bool
    hasCycle = func(node int) bool {
        if color[node] == 1 {
            return true
        }
        if color[node] == 2 {
            return false
        }
        
        color[node] = 1
        for _, neighbor := range graph[node] {
            if hasCycle(neighbor) {
                return true
            }
        }
        color[node] = 2
        return false
    }
    
    for i := 0; i < numCourses; i++ {
        if color[i] == 0 && hasCycle(i) {
            return false
        }
    }
    return true
}
```

---

# ç¤ºä¾‹æ¼”ç¤º

ä»¥ `numCourses = 4`, `prerequisites = [[1,0],[2,0],[3,1],[3,2]]` ä¸ºä¾‹ï¼š

```

è¯¾ç¨‹ä¾èµ–å›¾ï¼š
0 â†’ 1 â†’ 3
â†“ â†—
2 â”€â”€â”€â”€â”˜

```

- **æ‹“æ‰‘æ’åºè¿‡ç¨‹**ï¼š
  - åˆå§‹å…¥åº¦ï¼š`[0,1,1,2]`
  - å…¥åº¦ä¸º 0 çš„è¯¾ç¨‹ï¼š`0`
  - å¤„ç† `0` â†’ `1` å’Œ `2` å…¥åº¦å‡ä¸º 0 â†’ åŠ å…¥é˜Ÿåˆ—
  - å¤„ç† `1` â†’ `3` å…¥åº¦å‡ä¸º 1
  - å¤„ç† `2` â†’ `3` å…¥åº¦å‡ä¸º 0 â†’ åŠ å…¥é˜Ÿåˆ—
  - å¤„ç† `3`
  - å…±å¤„ç† 4 é—¨è¯¾ç¨‹ â‡’ è¿”å› `true`

âœ… æ— ç¯ï¼Œå¯ä»¥å®Œæˆã€‚

---

# ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

- **æ‹“æ‰‘æ’åºæ³•**ï¼šè‹¥å›¾ä¸­å­˜åœ¨ç¯ï¼Œåˆ™ç¯ä¸Šæ‰€æœ‰èŠ‚ç‚¹å…¥åº¦ â‰¥1ï¼Œæ°¸è¿œä¸ä¼šè¢«åŠ å…¥é˜Ÿåˆ—ï¼Œæœ€ç»ˆ `visited < numCourses`ã€‚
- **DFS ä¸‰è‰²æ³•**ï¼šè‹¥å­˜åœ¨ç¯ï¼Œåˆ™åœ¨ DFS è·¯å¾„ä¸­å¿…ä¼šå†æ¬¡è®¿é—®åˆ°çŠ¶æ€ä¸ºâ€œæ­£åœ¨è®¿é—®â€çš„èŠ‚ç‚¹ï¼ˆå³å›è¾¹ï¼‰ï¼Œä»è€Œæ£€æµ‹åˆ°ç¯ã€‚

ä¸¤ç§æ–¹æ³•å‡èƒ½**å……è¦åœ°**åˆ¤æ–­æœ‰å‘å›¾æ˜¯å¦å­˜åœ¨ç¯ï¼Œå› æ­¤è§£æ³•æ­£ç¡®ã€‚

---

# å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ |
|------|------------|------------|
| æ‹“æ‰‘æ’åºï¼ˆKahnï¼‰ | O(V + E) | O(V + E) |
| DFS ä¸‰è‰²æ ‡è®° | O(V + E) | O(V + E) |

å…¶ä¸­ï¼š
- V = `numCourses`ï¼ˆé¡¶ç‚¹æ•°ï¼‰
- E = `prerequisites.length`ï¼ˆè¾¹æ•°ï¼‰

ğŸ“Œ ä¸¤ç§æ–¹æ³•æ—¶é—´/ç©ºé—´å¤æ‚åº¦ç›¸åŒï¼Œå®é™…æ€§èƒ½å–å†³äºå›¾çš„ç»“æ„å’Œè¯­è¨€è¿è¡Œæ—¶ã€‚

---

# é—®é¢˜æ€»ç»“

âœ… **å…³é”®æ´å¯Ÿ**ï¼šè¯¾ç¨‹å®‰æ’é—®é¢˜ â‡¨ æœ‰å‘å›¾ç¯æ£€æµ‹ â‡¨ æ‹“æ‰‘æ’åº / DFS ç¯æ£€æµ‹ã€‚

âœ… **é€‚ç”¨åœºæ™¯**ï¼š
- æ‹“æ‰‘æ’åºï¼šéœ€è¾“å‡ºåˆæ³•é¡ºåºæ—¶ä¼˜å…ˆä½¿ç”¨ã€‚
- DFS ä¸‰è‰²æ³•ï¼šä»…éœ€åˆ¤æ–­å¯è¡Œæ€§æ—¶ä»£ç æ›´ç®€æ´ã€‚

âŒ **å¸¸è§è¯¯åŒº**ï¼š
- å¿½ç•¥å›¾å¯èƒ½ä¸è¿é€šï¼ˆéœ€éå†æ‰€æœ‰èŠ‚ç‚¹ï¼‰ã€‚
- ä½¿ç”¨æ™®é€š visited æ ‡è®°ï¼ˆæ— æ³•åŒºåˆ†â€œæ­£åœ¨è®¿é—®â€å’Œâ€œå·²å®Œæˆâ€ï¼‰ã€‚

ğŸ’¡ **æ‰©å±•æ€è€ƒ**ï¼š
- è‹¥éœ€è¾“å‡ºä»»æ„ä¸€ä¸ªåˆæ³•è¯¾ç¨‹é¡ºåºï¼Ÿâ†’ æ‹“æ‰‘æ’åºç»“æœå³ä¸ºç­”æ¡ˆã€‚
- è‹¥è¯¾ç¨‹æœ‰å­¦åˆ†ã€å­¦æœŸé™åˆ¶ï¼Ÿâ†’ å¯ç»“åˆåŠ¨æ€è§„åˆ’æˆ–åˆ†å±‚æ‹“æ‰‘æ’åºã€‚

æœ¬é¢˜æ˜¯**å›¾è®ºåŸºç¡€åº”ç”¨**çš„ç»å…¸ä»£è¡¨ï¼ŒæŒæ¡å…¶è§£æ³•å¯¹è§£å†³ä¾èµ–å…³ç³»ç±»é—®é¢˜è‡³å…³é‡è¦ã€‚
