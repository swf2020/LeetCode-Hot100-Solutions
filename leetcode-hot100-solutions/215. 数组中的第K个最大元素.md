## é—®é¢˜ç®€ä»‹

[LeetCode 215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ ](https://leetcode.cn/problems/kth-largest-element-in-an-array?envType=problem-list-v2&envId=2cktkvj)

### é¢˜ç›®æè¿°

ç»™å®šæ•´æ•°æ•°ç»„ `nums` å’Œæ•´æ•° `k`ï¼Œè¯·è¿”å›æ•°ç»„ä¸­ç¬¬ `k` ä¸ªæœ€å¤§çš„å…ƒç´ ã€‚

è¯·æ³¨æ„ï¼Œä½ éœ€è¦æ‰¾çš„æ˜¯æ•°ç»„æ’åºåçš„ç¬¬ `k` ä¸ªæœ€å¤§çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯ç¬¬ `k` ä¸ªä¸åŒçš„å…ƒç´ ã€‚

ä½ å¿…é¡»è®¾è®¡å¹¶å®ç°æ—¶é—´å¤æ‚åº¦ä¸º `O(n)` çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚

### ç¤ºä¾‹è¯´æ˜

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥: nums = [3,2,1,5,6,4], k = 2
è¾“å‡º: 5
è§£é‡Š: æ’åºåæ•°ç»„ä¸º [6,5,4,3,2,1]ï¼Œç¬¬2ä¸ªæœ€å¤§å…ƒç´ æ˜¯5
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥: nums = [3,2,3,1,2,4,5,5,6], k = 4
è¾“å‡º: 4
è§£é‡Š: æ’åºåæ•°ç»„ä¸º [6,5,5,4,3,3,2,2,1]ï¼Œç¬¬4ä¸ªæœ€å¤§å…ƒç´ æ˜¯4
```

## è§£é¢˜æ€è·¯

### æ–¹æ³•ä¸€ï¼šå¿«é€Ÿé€‰æ‹©ç®—æ³•ï¼ˆQuickSelectï¼‰âœ…

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼šåŸºäºå¿«é€Ÿæ’åºçš„åˆ†åŒºæ€æƒ³ï¼Œä½†åªé€’å½’å¤„ç†åŒ…å«ç›®æ ‡å…ƒç´ çš„é‚£ä¸€éƒ¨åˆ†ã€‚

**æ­¥éª¤è¯¦è§£ï¼š**

1. é€‰æ‹©ä¸€ä¸ªåŸºå‡†å…ƒç´ ï¼ˆpivotï¼‰
1. å°†æ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šå¤§äºç­‰äºpivotçš„åœ¨å·¦è¾¹ï¼Œå°äºpivotçš„åœ¨å³è¾¹
1. æ ¹æ®pivotçš„ä½ç½®ä¸kçš„å…³ç³»å†³å®šä¸‹ä¸€æ­¥ï¼š
   - å¦‚æœpivotä½ç½®æ­£å¥½æ˜¯k-1ï¼Œè¿”å›pivot
   - å¦‚æœpivotä½ç½®å¤§äºk-1ï¼Œåœ¨å·¦åŠéƒ¨åˆ†ç»§ç»­æŸ¥æ‰¾
   - å¦‚æœpivotä½ç½®å°äºk-1ï¼Œåœ¨å³åŠéƒ¨åˆ†ç»§ç»­æŸ¥æ‰¾

### æ–¹æ³•äºŒï¼šå †æ’åºï¼ˆæœ€å°å †ï¼‰âœ…

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼šç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸ºkçš„æœ€å°å †ï¼Œå †é¡¶å°±æ˜¯ç¬¬kå¤§çš„å…ƒç´ ã€‚

**æ­¥éª¤è¯¦è§£ï¼š**

1. åˆ›å»ºä¸€ä¸ªå®¹é‡ä¸ºkçš„æœ€å°å †
1. éå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼š
   - å¦‚æœå †çš„å¤§å°å°äºkï¼Œç›´æ¥åŠ å…¥
   - å¦‚æœå½“å‰å…ƒç´ å¤§äºå †é¡¶ï¼Œå¼¹å‡ºå †é¡¶å¹¶åŠ å…¥å½“å‰å…ƒç´ 
1. æœ€ç»ˆå †é¡¶å°±æ˜¯ç¬¬kå¤§çš„å…ƒç´ 

### æ–¹æ³•ä¸‰ï¼šæ’åºåç›´æ¥å–å€¼ âŒ

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼šç›´æ¥å¯¹æ•°ç»„æ’åºï¼Œç„¶åå–ç¬¬kä¸ªæœ€å¤§å…ƒç´ ã€‚

**æ­¥éª¤è¯¦è§£ï¼š**

1. å¯¹æ•°ç»„è¿›è¡Œé™åºæ’åº
1. è¿”å›ç´¢å¼•ä¸ºk-1çš„å…ƒç´ 

> âš ï¸ æ³¨æ„ï¼šè™½ç„¶è¿™ç§æ–¹æ³•ç®€å•ï¼Œä½†æ—¶é—´å¤æ‚åº¦ä¸ºO(n log n)ï¼Œä¸æ»¡è¶³é¢˜ç›®è¦æ±‚çš„O(n)æ—¶é—´å¤æ‚åº¦ã€‚

## ä»£ç å®ç°

```java
// æ–¹æ³•ä¸€ï¼šå¿«é€Ÿé€‰æ‹©ç®—æ³•
class Solution {
    public int findKthLargest(int[] nums, int k) {
        return quickSelect(nums, 0, nums.length - 1, k - 1);
    }
    
    private int quickSelect(int[] nums, int left, int right, int k) {
        if (left == right) {
            return nums[left];
        }
        
        // éšæœºé€‰æ‹©pivotä»¥é¿å…æœ€åæƒ…å†µ
        Random random = new Random();
        int pivotIndex = left + random.nextInt(right - left + 1);
        pivotIndex = partition(nums, left, right, pivotIndex);
        
        if (k == pivotIndex) {
            return nums[k];
        } else if (k < pivotIndex) {
            return quickSelect(nums, left, pivotIndex - 1, k);
        } else {
            return quickSelect(nums, pivotIndex + 1, right, k);
        }
    }
    
    private int partition(int[] nums, int left, int right, int pivotIndex) {
        int pivotValue = nums[pivotIndex];
        // å°†pivotç§»åˆ°æœ«å°¾
        swap(nums, pivotIndex, right);
        int storeIndex = left;
        
        // å°†æ‰€æœ‰å¤§äºpivotçš„å…ƒç´ ç§»åˆ°å·¦è¾¹
        for (int i = left; i < right; i++) {
            if (nums[i] > pivotValue) {
                swap(nums, storeIndex, i);
                storeIndex++;
            }
        }
        
        // å°†pivotæ”¾åˆ°æ­£ç¡®ä½ç½®
        swap(nums, storeIndex, right);
        return storeIndex;
    }
    
    private void swap(int[] nums, int i, int j) {
        int temp = nums[i];
        nums[i] = nums[j];
        nums[j] = temp;
    }
}

// æ–¹æ³•äºŒï¼šæœ€å°å †
class Solution {
    public int findKthLargest(int[] nums, int k) {
        PriorityQueue<Integer> minHeap = new PriorityQueue<>();
        
        for (int num : nums) {
            if (minHeap.size() < k) {
                minHeap.offer(num);
            } else if (num > minHeap.peek()) {
                minHeap.poll();
                minHeap.offer(num);
            }
        }
        
        return minHeap.peek();
    }
}
```

```go
// æ–¹æ³•ä¸€ï¼šå¿«é€Ÿé€‰æ‹©ç®—æ³•
import (
    "math/rand"
    "time"
)

func findKthLargest(nums []int, k int) int {
    rand.Seed(time.Now().UnixNano())
    return quickSelect(nums, 0, len(nums)-1, k-1)
}

func quickSelect(nums []int, left, right, k int) int {
    if left == right {
        return nums[left]
    }
    
    pivotIndex := left + rand.Intn(right-left+1)
    pivotIndex = partition(nums, left, right, pivotIndex)
    
    if k == pivotIndex {
        return nums[k]
    } else if k < pivotIndex {
        return quickSelect(nums, left, pivotIndex-1, k)
    } else {
        return quickSelect(nums, pivotIndex+1, right, k)
    }
}

func partition(nums []int, left, right, pivotIndex int) int {
    pivotValue := nums[pivotIndex]
    // å°†pivotç§»åˆ°æœ«å°¾
    nums[pivotIndex], nums[right] = nums[right], nums[pivotIndex]
    storeIndex := left
    
    // å°†æ‰€æœ‰å¤§äºpivotçš„å…ƒç´ ç§»åˆ°å·¦è¾¹
    for i := left; i < right; i++ {
        if nums[i] > pivotValue {
            nums[storeIndex], nums[i] = nums[i], nums[storeIndex]
            storeIndex++
        }
    }
    
    // å°†pivotæ”¾åˆ°æ­£ç¡®ä½ç½®
    nums[storeIndex], nums[right] = nums[right], nums[storeIndex]
    return storeIndex
}

// æ–¹æ³•äºŒï¼šæœ€å°å †
import "container/heap"

type MinHeap []int

func (h MinHeap) Len() int           { return len(h) }
func (h MinHeap) Less(i, j int) bool { return h[i] < h[j] }
func (h MinHeap) Swap(i, j int)      { h[i], h[j] = h[j], h[i] }
func (h *MinHeap) Push(x interface{}) { *h = append(*h, x.(int)) }
func (h *MinHeap) Pop() interface{} {
    old := *h
    n := len(old)
    x := old[n-1]
    *h = old[0 : n-1]
    return x
}

func findKthLargest(nums []int, k int) int {
    minHeap := &MinHeap{}
    heap.Init(minHeap)
    
    for _, num := range nums {
        if minHeap.Len() < k {
            heap.Push(minHeap, num)
        } else if num > (*minHeap)[0] {
            heap.Pop(minHeap)
            heap.Push(minHeap, num)
        }
    }
    
    return (*minHeap)[0]
}
```


## ç¤ºä¾‹æ¼”ç¤º

ğŸ“Œ **ä»¥ç¤ºä¾‹1ä¸ºä¾‹ï¼šnums = [3,2,1,5,6,4], k = 2**

### å¿«é€Ÿé€‰æ‹©è¿‡ç¨‹ï¼š
1. åˆå§‹æ•°ç»„ï¼š[3,2,1,5,6,4]ï¼Œå¯»æ‰¾ç¬¬2å¤§å…ƒç´ ï¼ˆç´¢å¼•1ï¼‰
2. å‡è®¾é€‰æ‹©pivot=4ï¼Œåˆ†åŒºåï¼š[6,5,4,3,2,1]ï¼Œpivotä½ç½®=2
3. ç”±äºk-1=1 < 2ï¼Œæ‰€ä»¥åœ¨å·¦åŠéƒ¨åˆ†[6,5]ä¸­ç»§ç»­æŸ¥æ‰¾
4. åœ¨[6,5]ä¸­é€‰æ‹©pivot=5ï¼Œåˆ†åŒºåï¼š[6,5]ï¼Œpivotä½ç½®=1
5. k-1=1 == pivotä½ç½®ï¼Œè¿”å›5

### æœ€å°å †è¿‡ç¨‹ï¼š
1. åˆå§‹åŒ–ç©ºå †
2. ä¾æ¬¡åŠ å…¥ï¼š3â†’[3], 2â†’[2,3], 1â†’[1,2,3]ï¼ˆä½†å †å¤§å°é™åˆ¶ä¸º2ï¼Œå®é™…ä¸º[2,3]ï¼‰
3. åŠ å…¥5ï¼š5>2ï¼Œå¼¹å‡º2ï¼ŒåŠ å…¥5â†’[3,5]
4. åŠ å…¥6ï¼š6>3ï¼Œå¼¹å‡º3ï¼ŒåŠ å…¥6â†’[5,6]
5. åŠ å…¥4ï¼š4<5ï¼Œä¸åŠ å…¥
6. æœ€ç»ˆå †é¡¶ä¸º5

## ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

âœ… **å¿«é€Ÿé€‰æ‹©ç®—æ³•æ­£ç¡®æ€§ï¼š**
- åŸºäºå¿«é€Ÿæ’åºçš„åˆ†åŒºæ€§è´¨ï¼šæ¯æ¬¡åˆ†åŒºåï¼Œpivotå…ƒç´ éƒ½åœ¨å…¶æœ€ç»ˆæ’åºä½ç½®
- é€šè¿‡æ¯”è¾ƒpivotä½ç½®ä¸ç›®æ ‡ä½ç½®k-1çš„å…³ç³»ï¼Œå¯ä»¥ç¡®å®šç›®æ ‡å…ƒç´ åœ¨å“ªä¸ªå­åŒºé—´
- é€’å½’ç¼©å°æœç´¢èŒƒå›´ï¼Œæœ€ç»ˆå¿…ç„¶æ‰¾åˆ°ç¬¬kå¤§å…ƒç´ 

âœ… **æœ€å°å †ç®—æ³•æ­£ç¡®æ€§ï¼š**
- ç»´æŠ¤å¤§å°ä¸ºkçš„æœ€å°å †ï¼Œä¿è¯å †ä¸­å§‹ç»ˆåŒ…å«å½“å‰éå†è¿‡çš„kä¸ªæœ€å¤§å…ƒç´ 
- å †é¡¶æ˜¯è¿™kä¸ªå…ƒç´ ä¸­çš„æœ€å°å€¼ï¼Œä¹Ÿå°±æ˜¯ç¬¬kå¤§çš„å…ƒç´ 
- éå†å®Œæ•´ä¸ªæ•°ç»„åï¼Œå †ä¸­åŒ…å«å…¨å±€æœ€å¤§çš„kä¸ªå…ƒç´ ï¼Œå †é¡¶å³ä¸ºç­”æ¡ˆ

## å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | æ˜¯å¦æ»¡è¶³O(n)è¦æ±‚ |
|------|------------|------------|------------------|
| å¿«é€Ÿé€‰æ‹© | å¹³å‡O(n)ï¼Œæœ€åO(nÂ²) | O(1) | âœ… å¹³å‡æƒ…å†µä¸‹æ»¡è¶³ |
| æœ€å°å † | O(n log k) | O(k) | âŒ ä¸ä¸¥æ ¼æ»¡è¶³O(n) |
| æ’åº | O(n log n) | O(1)æˆ–O(n) | âŒ ä¸æ»¡è¶³ |

ğŸ’¡ **å…³é”®ç‚¹è¯´æ˜ï¼š**
- å¿«é€Ÿé€‰æ‹©çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œå› ä¸ºæ¯æ¬¡æœŸæœ›èƒ½æ’é™¤ä¸€åŠçš„å…ƒç´ 
- é€šè¿‡éšæœºé€‰æ‹©pivotï¼Œå¯ä»¥é¿å…æœ€åæƒ…å†µï¼ˆå·²æ’åºæ•°ç»„ï¼‰çš„å‘ç”Ÿ
- å½“kè¾ƒå°æ—¶ï¼Œå †æ–¹æ³•çš„å®é™…æ€§èƒ½å¯èƒ½æ›´å¥½ï¼Œå› ä¸ºlog kå¾ˆå°

## é—®é¢˜æ€»ç»“

ğŸ“Œ **æ ¸å¿ƒè¦ç‚¹ï¼š**
1. **å¿«é€Ÿé€‰æ‹©æ˜¯æœ€ä½³è§£æ³•**ï¼šå¹³å‡æ—¶é—´å¤æ‚åº¦O(n)ï¼Œç©ºé—´å¤æ‚åº¦O(1)
2. **å †æ–¹æ³•å®ç”¨æ€§å¼º**ï¼šè™½ç„¶ç†è®ºå¤æ‚åº¦ä¸æ˜¯O(n)ï¼Œä½†åœ¨kè¾ƒå°æ—¶è¡¨ç°ä¼˜ç§€
3. **éšæœºåŒ–å¾ˆé‡è¦**ï¼šé¿å…å¿«é€Ÿé€‰æ‹©åœ¨ç‰¹æ®Šè¾“å…¥ä¸‹çš„æœ€åæƒ…å†µ

ğŸ’¡ **é¢è¯•å»ºè®®ï¼š**
- é¦–å…ˆæå‡ºå¿«é€Ÿé€‰æ‹©ç®—æ³•ï¼Œå±•ç¤ºå¯¹åˆ†æ²»æ€æƒ³çš„ç†è§£
- è®¨è®ºå †æ–¹æ³•ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆï¼Œä½“ç°å¤šè§’åº¦æ€è€ƒèƒ½åŠ›
- å¼ºè°ƒéšæœºåŒ–çš„é‡è¦æ€§ï¼Œå±•ç¤ºå¯¹ç®—æ³•é²æ£’æ€§çš„è€ƒè™‘

âœ… **é€‚ç”¨åœºæ™¯ï¼š**
- å¿«é€Ÿé€‰æ‹©ï¼šéœ€è¦ä¸¥æ ¼O(n)æ—¶é—´å¤æ‚åº¦çš„åœºæ™¯
- æœ€å°å †ï¼škç›¸å¯¹è¾ƒå°ï¼Œæˆ–è€…éœ€è¦åœ¨çº¿å¤„ç†æ•°æ®æµçš„åœºæ™¯
