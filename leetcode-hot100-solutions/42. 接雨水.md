#  æ¥é›¨æ°´ï¼ˆLeetCode 42ï¼‰

## é—®é¢˜ç®€ä»‹

ğŸ”— [LeetCode 42. æ¥é›¨æ°´](https://leetcode.cn/problems/trapping-rain-water?envType=problem-list-v2&envId=2cktkvj)

### é¢˜ç›®æè¿°

ç»™å®š `n` ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º `1` çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚

______________________________________________________________________

## ç¤ºä¾‹è¯´æ˜

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šheight = [0,1,0,2,1,0,1,3,2,1,2,1]
è¾“å‡ºï¼š6
è§£é‡Šï¼šä¸Šé¢æ˜¯ç”±æ•°ç»„ [0,1,0,2,1,0,1,3,2,1,2,1] è¡¨ç¤ºçš„é«˜åº¦å›¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¥ 6 ä¸ªå•ä½çš„é›¨æ°´ï¼ˆè“è‰²éƒ¨åˆ†è¡¨ç¤ºé›¨æ°´ï¼‰ã€‚
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šheight = [4,2,0,3,2,5]
è¾“å‡ºï¼š9
```

______________________________________________________________________

## è§£é¢˜æ€è·¯

### ğŸ’¡ æ€è·¯ä¸€ï¼šæš´åŠ›æ³•ï¼ˆä¸æ¨èï¼Œä»…ç”¨äºç†è§£ï¼‰

å¯¹æ¯ä¸ªæŸ±å­ï¼Œæ‰¾å‡ºå…¶å·¦è¾¹æœ€å¤§é«˜åº¦å’Œå³è¾¹æœ€å¤§é«˜åº¦ï¼Œå½“å‰æŸ±å­èƒ½æ¥çš„é›¨æ°´ä¸ºï¼š

```
water[i] = max(0, min(leftMax, rightMax) - height[i])
```

- æ—¶é—´å¤æ‚åº¦é«˜ï¼ŒO(nÂ²)ï¼Œç©ºé—´ O(1)

______________________________________________________________________

### âœ… æ€è·¯äºŒï¼šåŠ¨æ€è§„åˆ’ï¼ˆé¢„å¤„ç†å·¦å³æœ€å¤§å€¼ï¼‰

1. åˆ›å»ºä¸¤ä¸ªæ•°ç»„ `leftMax` å’Œ `rightMax`ï¼š
   - `leftMax[i]` è¡¨ç¤ºä» `0` åˆ° `i` çš„æœ€å¤§é«˜åº¦
   - `rightMax[i]` è¡¨ç¤ºä» `i` åˆ° `n-1` çš„æœ€å¤§é«˜åº¦
1. å†éå†ä¸€æ¬¡ï¼Œç´¯åŠ æ¯ä¸ªä½ç½®çš„é›¨æ°´é‡

**ä¼˜ç‚¹**ï¼šæ¸…æ™°æ˜“æ‡‚\
**ç¼ºç‚¹**ï¼šéœ€è¦é¢å¤– O(n) ç©ºé—´

______________________________________________________________________

### âœ… æ€è·¯ä¸‰ï¼šåŒæŒ‡é’ˆï¼ˆæœ€ä¼˜è§£ï¼‰

åˆ©ç”¨åŒæŒ‡é’ˆä»ä¸¤ç«¯å‘ä¸­é—´ç§»åŠ¨ï¼š

- ç»´æŠ¤ `leftMax` å’Œ `rightMax`
- è‹¥ `leftMax < rightMax`ï¼Œåˆ™å·¦ä¾§æŸ±å­çš„é›¨æ°´é‡ç”± `leftMax` å†³å®šï¼ˆå› ä¸ºå³ä¾§æœ‰æ›´é«˜çš„å¢™ï¼‰
- åä¹‹äº¦ç„¶

**ä¼˜ç‚¹**ï¼šæ—¶é—´ O(n)ï¼Œç©ºé—´ O(1)ï¼Œæ•ˆç‡æœ€é«˜

______________________________________________________________________

### âœ… æ€è·¯å››ï¼šå•è°ƒæ ˆ

ä½¿ç”¨å•è°ƒé€’å‡æ ˆå­˜å‚¨ç´¢å¼•ï¼š

- å½“é‡åˆ°æ¯”æ ˆé¡¶é«˜çš„æŸ±å­æ—¶ï¼Œè¯´æ˜å¯ä»¥å½¢æˆå‡¹æ§½
- å¼¹å‡ºæ ˆé¡¶ï¼Œè®¡ç®—ä»¥è¯¥ä½ç½®ä¸ºåº•çš„é›¨æ°´é¢ç§¯

é€‚ç”¨äºâ€œæ‰¾æœ€è¿‘æ›´å¤§å…ƒç´ â€ç±»é—®é¢˜ï¼Œä½†æœ¬é¢˜ä¸­ä¸å¦‚åŒæŒ‡é’ˆç®€æ´

______________________________________________________________________

## ä»£ç å®ç°


```java:Java
// æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’
class Solution {
    public int trap(int[] height) {
        if (height == null || height.length == 0) return 0;
        int n = height.length;
        int[] leftMax = new int[n];
        int[] rightMax = new int[n];
        
        leftMax[0] = height[0];
        for (int i = 1; i < n; i++) {
            leftMax[i] = Math.max(leftMax[i - 1], height[i]);
        }
        
        rightMax[n - 1] = height[n - 1];
        for (int i = n - 2; i >= 0; i--) {
            rightMax[i] = Math.max(rightMax[i + 1], height[i]);
        }
        
        int water = 0;
        for (int i = 0; i < n; i++) {
            water += Math.min(leftMax[i], rightMax[i]) - height[i];
        }
        return water;
    }
}

// æ–¹æ³•äºŒï¼šåŒæŒ‡é’ˆï¼ˆæ¨èï¼‰
class Solution {
    public int trap(int[] height) {
        if (height == null || height.length == 0) return 0;
        int left = 0, right = height.length - 1;
        int leftMax = 0, rightMax = 0;
        int water = 0;
        
        while (left < right) {
            if (height[left] < height[right]) {
                if (height[left] >= leftMax) {
                    leftMax = height[left];
                } else {
                    water += leftMax - height[left];
                }
                left++;
            } else {
                if (height[right] >= rightMax) {
                    rightMax = height[right];
                } else {
                    water += rightMax - height[right];
                }
                right--;
            }
        }
        return water;
    }
}
```

```go:Go
// æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’
func trap(height []int) int {
    n := len(height)
    if n == 0 {
        return 0
    }
    
    leftMax := make([]int, n)
    rightMax := make([]int, n)
    
    leftMax[0] = height[0]
    for i := 1; i < n; i++ {
        leftMax[i] = max(leftMax[i-1], height[i])
    }
    
    rightMax[n-1] = height[n-1]
    for i := n - 2; i >= 0; i-- {
        rightMax[i] = max(rightMax[i+1], height[i])
    }
    
    water := 0
    for i := 0; i < n; i++ {
        water += min(leftMax[i], rightMax[i]) - height[i]
    }
    return water
}

// æ–¹æ³•äºŒï¼šåŒæŒ‡é’ˆï¼ˆæ¨èï¼‰
func trap(height []int) int {
    if len(height) == 0 {
        return 0
    }
    
    left, right := 0, len(height)-1
    leftMax, rightMax := 0, 0
    water := 0
    
    for left < right {
        if height[left] < height[right] {
            if height[left] >= leftMax {
                leftMax = height[left]
            } else {
                water += leftMax - height[left]
            }
            left++
        } else {
            if height[right] >= rightMax {
                rightMax = height[right]
            } else {
                water += rightMax - height[right]
            }
            right--
        }
    }
    return water
}

func max(a, b int) int {
    if a > b {
        return a
    }
    return b
}

func min(a, b int) int {
    if a < b {
        return a
    }
    return b
}
```

______________________________________________________________________

## ç¤ºä¾‹æ¼”ç¤º

ä»¥ `height = [0,1,0,2,1,0,1,3,2,1,2,1]` ä¸ºä¾‹ï¼š

| i | height[i] | leftMax | rightMax | min(L,R) | water[i] |
|---|-----------|---------|----------|----------|----------|
| 0 | 0 | 0 | 3 | 0 | 0 |
| 1 | 1 | 1 | 3 | 1 | 0 |
| 2 | 0 | 1 | 3 | 1 | **1** |
| 3 | 2 | 2 | 3 | 2 | 0 |
| 4 | 1 | 2 | 3 | 2 | **1** |
| 5 | 0 | 2 | 3 | 2 | **2** |
| 6 | 1 | 2 | 3 | 2 | **1** |
| 7 | 3 | 3 | 3 | 3 | 0 |
| 8 | 2 | 3 | 2 | 2 | 0 |
| 9 | 1 | 3 | 2 | 2 | **1** |
|10 | 2 | 3 | 2 | 2 | 0 |
|11 | 1 | 3 | 1 | 1 | 0 |

âœ… æ€»é›¨æ°´ = 1+1+2+1+1 = **6**

______________________________________________________________________

## ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

**å…³é”®è§‚å¯Ÿ**ï¼š\
ä¸€ä¸ªä½ç½® `i` èƒ½æ¥çš„é›¨æ°´é«˜åº¦ï¼Œå–å†³äºå…¶**å·¦ä¾§æœ€é«˜å¢™**å’Œ**å³ä¾§æœ€é«˜å¢™**ä¸­çš„è¾ƒå°è€…ã€‚

> **å¼•ç†**ï¼šè‹¥ `leftMax[i] â‰¤ rightMax[i]`ï¼Œåˆ™ `i` å¤„çš„ç§¯æ°´é«˜åº¦ä¸º `leftMax[i] - height[i]`ï¼ˆå‰ææ˜¯ `leftMax[i] > height[i]`ï¼‰

**åŒæŒ‡é’ˆæ­£ç¡®æ€§**ï¼š

- å½“ `height[left] < height[right]` æ—¶ï¼Œ`leftMax â‰¤ rightMax` å¿…ç„¶æˆç«‹ï¼ˆå› ä¸º `rightMax` è‡³å°‘ä¸º `height[right]`ï¼‰
- å› æ­¤ `left` ä½ç½®çš„ç§¯æ°´ç”± `leftMax` å†³å®šï¼Œæ— éœ€çŸ¥é“å…¨å±€ `rightMax`
- åŒç†é€‚ç”¨äºå³ä¾§

é€šè¿‡æ•°å­¦å½’çº³æ³•å¯ä¸¥æ ¼è¯æ˜ç®—æ³•æ­£ç¡®æ€§ã€‚

______________________________________________________________________

## å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | è¯´æ˜ |
|--------------|------------|------------|--------------------------|
| æš´åŠ›æ³• | O(nÂ²) | O(1) | æ¯ä¸ªä½ç½®éå†å·¦å³ |
| åŠ¨æ€è§„åˆ’ | O(n) | O(n) | ä¸¤æ¬¡é¢„å¤„ç† + ä¸€æ¬¡è®¡ç®— |
| **åŒæŒ‡é’ˆ** | **O(n)** | **O(1)** | **æœ€ä¼˜è§£ï¼Œæ¨èä½¿ç”¨** |
| å•è°ƒæ ˆ | O(n) | O(n) | æ¯ä¸ªå…ƒç´ å…¥æ ˆå‡ºæ ˆä¸€æ¬¡ |

______________________________________________________________________

## é—®é¢˜æ€»ç»“

ğŸ“Œ **æ ¸å¿ƒæ€æƒ³**ï¼šæ¯ä¸ªä½ç½®çš„ç§¯æ°´ç”±â€œçŸ­æ¿æ•ˆåº”â€å†³å®šâ€”â€”å³å·¦å³ä¸¤ä¾§æœ€é«˜å¢™çš„è¾ƒå°å€¼ã€‚

âœ… **æœ€ä½³å®è·µ**ï¼šåŒæŒ‡é’ˆæ³•åœ¨ä¿è¯çº¿æ€§æ—¶é—´çš„åŒæ—¶ï¼Œå°†ç©ºé—´å‹ç¼©åˆ°å¸¸æ•°çº§åˆ«ï¼Œæ˜¯é¢è¯•å’Œç«èµ›ä¸­çš„é¦–é€‰è§£æ³•ã€‚

ğŸ’¡ **å»¶ä¼¸æ€è€ƒ**ï¼š

- äºŒç»´æ¥é›¨æ°´ï¼ˆLeetCode 407ï¼‰å¯ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆæœ€å°å †ï¼‰è§£å†³
- è‹¥å…è®¸ä¿®æ”¹åŸæ•°ç»„ï¼Œå¯è¿›ä¸€æ­¥ä¼˜åŒ–ç©ºé—´ï¼ˆä½†é€šå¸¸ä¸å»ºè®®ï¼‰

æŒæ¡æœ¬é¢˜çš„å¤šç§è§£æ³•ï¼Œæœ‰åŠ©äºæ·±å…¥ç†è§£**å‰ç¼€/åç¼€æœ€å€¼**ã€**åŒæŒ‡é’ˆæŠ€å·§**å’Œ**å•è°ƒæ ˆ**çš„åº”ç”¨åœºæ™¯ã€‚
