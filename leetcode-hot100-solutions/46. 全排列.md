# 46. å…¨æ’åˆ—

[LeetCode é¢˜ç›®é“¾æ¥](https://leetcode.cn/problems/permutations?envType=problem-list-v2&envId=2cktkvj)

## âŒ|âœ…|ğŸ’¡|ğŸ“Œ é—®é¢˜ç®€ä»‹

ç»™å®šä¸€ä¸ªä¸å«é‡å¤æ•°å­—çš„æ•°ç»„ `nums`ï¼Œè¿”å›å…¶æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—ã€‚ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚

### é¢˜ç›®æè¿°

> ç»™å®šä¸€ä¸ªä¸å«é‡å¤æ•°å­—çš„æ•°ç»„ `nums`ï¼Œè¿”å›å…¶æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—ã€‚ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚

### ç¤ºä¾‹è¯´æ˜

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šnums = [1,2,3]
è¾“å‡ºï¼š[[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šnums = [0,1]
è¾“å‡ºï¼š[[0,1],[1,0]]
```

**ç¤ºä¾‹ 3ï¼š**

```
è¾“å…¥ï¼šnums = [1]
è¾“å‡ºï¼š[[1]]
```

**çº¦æŸæ¡ä»¶ï¼š**

- `1 <= nums.length <= 6`
- `-10 <= nums[i] <= 10`
- `nums` ä¸­çš„æ‰€æœ‰æ•´æ•°äº’ä¸ç›¸åŒ

______________________________________________________________________

## ğŸ’¡ è§£é¢˜æ€è·¯

å…¨æ’åˆ—é—®é¢˜æ˜¯ç»å…¸çš„å›æº¯ç®—æ³•ï¼ˆBacktrackingï¼‰åº”ç”¨åœºæ™¯ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**åœ¨æ¯ä¸€æ­¥é€‰æ‹©ä¸€ä¸ªæœªè¢«ä½¿ç”¨çš„å…ƒç´ åŠ å…¥å½“å‰è·¯å¾„ï¼Œé€’å½’å¤„ç†å‰©ä½™å…ƒç´ ï¼Œå›æº¯æ—¶æ’¤é”€é€‰æ‹©**ã€‚

### æ–¹æ³•ä¸€ï¼šå›æº¯æ³•ï¼ˆä½¿ç”¨ visited æ•°ç»„ï¼‰

**æ­¥éª¤è¯¦è§£ï¼š**

1. **çŠ¶æ€è¡¨ç¤º**ï¼š

   - `path`ï¼šå½“å‰æ­£åœ¨æ„å»ºçš„æ’åˆ—
   - `visited`ï¼šå¸ƒå°”æ•°ç»„ï¼Œè®°å½•å“ªäº›å…ƒç´ å·²è¢«ä½¿ç”¨

1. **é€’å½’ç»ˆæ­¢æ¡ä»¶**ï¼š

   - å½“ `path` çš„é•¿åº¦ç­‰äº `nums` çš„é•¿åº¦æ—¶ï¼Œè¯´æ˜æ‰¾åˆ°ä¸€ä¸ªå®Œæ•´æ’åˆ—ï¼Œå°†å…¶åŠ å…¥ç»“æœé›†

1. **é€‰æ‹©ä¸æ’¤é”€**ï¼š

   - éå†æ‰€æœ‰å…ƒç´ ï¼Œå¯¹æ¯ä¸ªæœªè¢«ä½¿ç”¨çš„å…ƒç´ ï¼š
     - **åšé€‰æ‹©**ï¼šå°†å…¶åŠ å…¥ `path`ï¼Œæ ‡è®°ä¸ºå·²ä½¿ç”¨
     - **é€’å½’**ï¼šç»§ç»­æ„å»ºä¸‹ä¸€ä¸ªä½ç½®
     - **æ’¤é”€é€‰æ‹©**ï¼šä» `path` ä¸­ç§»é™¤ï¼Œæ ‡è®°ä¸ºæœªä½¿ç”¨ï¼ˆå›æº¯ï¼‰

1. **é¿å…é‡å¤**ï¼š

   - ç”±äºé¢˜ç›®ä¿è¯æ— é‡å¤å…ƒç´ ï¼Œæ— éœ€é¢å¤–å»é‡é€»è¾‘

### æ–¹æ³•äºŒï¼šå›æº¯æ³•ï¼ˆåŸåœ°äº¤æ¢ï¼‰

**ä¼˜åŒ–æ€è·¯ï¼š**

- ä¸ä½¿ç”¨é¢å¤–çš„ `visited` æ•°ç»„ï¼Œè€Œæ˜¯é€šè¿‡äº¤æ¢å…ƒç´ ä½ç½®æ¥å®ç°
- å°†å·²ç¡®å®šä½ç½®çš„å…ƒç´ æ”¾åœ¨æ•°ç»„å‰éƒ¨ï¼Œæœªç¡®å®šçš„æ”¾åœ¨åéƒ¨
- é€’å½’æ—¶åªè€ƒè™‘æœªç¡®å®šéƒ¨åˆ†çš„å…ƒç´ 

**æ­¥éª¤ï¼š**

1. ä»ä½ç½® `start` å¼€å§‹ï¼Œå°è¯•å°†æ¯ä¸ªåç»­å…ƒç´ ä¸ `start` ä½ç½®äº¤æ¢
1. é€’å½’å¤„ç† `start + 1` ä½ç½®
1. å›æº¯æ—¶äº¤æ¢å›æ¥ï¼Œæ¢å¤åŸæ•°ç»„çŠ¶æ€

______________________________________________________________________

## ğŸ’» ä»£ç å®ç°

```java
// æ–¹æ³•ä¸€ï¼šå›æº¯ + visited æ•°ç»„
class Solution {
    public List<List<Integer>> permute(int[] nums) {
        List<List<Integer>> result = new ArrayList<>();
        List<Integer> path = new ArrayList<>();
        boolean[] visited = new boolean[nums.length];
        backtrack(nums, path, visited, result);
        return result;
    }
    
    private void backtrack(int[] nums, List<Integer> path, 
                          boolean[] visited, List<List<Integer>> result) {
        // é€’å½’ç»ˆæ­¢æ¡ä»¶
        if (path.size() == nums.length) {
            result.add(new ArrayList<>(path));
            return;
        }
        
        // å°è¯•æ¯ä¸ªæœªä½¿ç”¨çš„å…ƒç´ 
        for (int i = 0; i < nums.length; i++) {
            if (!visited[i]) {
                // åšé€‰æ‹©
                path.add(nums[i]);
                visited[i] = true;
                
                // é€’å½’
                backtrack(nums, path, visited, result);
                
                // æ’¤é”€é€‰æ‹©ï¼ˆå›æº¯ï¼‰
                path.remove(path.size() - 1);
                visited[i] = false;
            }
        }
    }
}

// æ–¹æ³•äºŒï¼šå›æº¯ + åŸåœ°äº¤æ¢
class Solution {
    public List<List<Integer>> permute(int[] nums) {
        List<List<Integer>> result = new ArrayList<>();
        backtrack(nums, 0, result);
        return result;
    }
    
    private void backtrack(int[] nums, int start, List<List<Integer>> result) {
        if (start == nums.length) {
            // å°†å½“å‰æ’åˆ—è½¬æ¢ä¸ºListå¹¶æ·»åŠ åˆ°ç»“æœ
            List<Integer> permutation = new ArrayList<>();
            for (int num : nums) {
                permutation.add(num);
            }
            result.add(permutation);
            return;
        }
        
        for (int i = start; i < nums.length; i++) {
            // äº¤æ¢
            swap(nums, start, i);
            // é€’å½’
            backtrack(nums, start + 1, result);
            // å›æº¯
            swap(nums, start, i);
        }
    }
    
    private void swap(int[] nums, int i, int j) {
        int temp = nums[i];
        nums[i] = nums[j];
        nums[j] = temp;
    }
}
````

```go
// æ–¹æ³•ä¸€ï¼šå›æº¯ + visited æ•°ç»„
func permute(nums []int) [][]int {
    result := [][]int{}
    path := []int{}
    visited := make([]bool, len(nums))
    backtrack(nums, path, visited, &result)
    return result
}

func backtrack(nums []int, path []int, visited []bool, result *[][]int) {
    // é€’å½’ç»ˆæ­¢æ¡ä»¶
    if len(path) == len(nums) {
        // æ³¨æ„ï¼šéœ€è¦åˆ›å»ºpathçš„å‰¯æœ¬
        temp := make([]int, len(path))
        copy(temp, path)
        *result = append(*result, temp)
        return
    }
    
    // å°è¯•æ¯ä¸ªæœªä½¿ç”¨çš„å…ƒç´ 
    for i := 0; i < len(nums); i++ {
        if !visited[i] {
            // åšé€‰æ‹©
            path = append(path, nums[i])
            visited[i] = true
            
            // é€’å½’
            backtrack(nums, path, visited, result)
            
            // æ’¤é”€é€‰æ‹©ï¼ˆå›æº¯ï¼‰
            path = path[:len(path)-1]
            visited[i] = false
        }
    }
}

// æ–¹æ³•äºŒï¼šå›æº¯ + åŸåœ°äº¤æ¢
func permute(nums []int) [][]int {
    result := [][]int{}
    backtrackSwap(nums, 0, &result)
    return result
}

func backtrackSwap(nums []int, start int, result *[][]int) {
    if start == len(nums) {
        // åˆ›å»ºå½“å‰æ’åˆ—çš„å‰¯æœ¬
        temp := make([]int, len(nums))
        copy(temp, nums)
        *result = append(*result, temp)
        return
    }
    
    for i := start; i < len(nums); i++ {
        // äº¤æ¢
        nums[start], nums[i] = nums[i], nums[start]
        // é€’å½’
        backtrackSwap(nums, start+1, result)
        // å›æº¯
        nums[start], nums[i] = nums[i], nums[start]
    }
}
```

---

## ğŸ“Š ç¤ºä¾‹æ¼”ç¤º

ä»¥ `nums = [1,2,3]` ä¸ºä¾‹ï¼Œå±•ç¤ºå›æº¯è¿‡ç¨‹ï¼š

```

åˆå§‹çŠ¶æ€: path=[], visited=[F,F,F]

ç¬¬1å±‚é€‰æ‹©:
â”œâ”€ é€‰æ‹©1: path=[1], visited=[T,F,F]
â”‚ â”œâ”€ é€‰æ‹©2: path=[1,2], visited=[T,T,F]
â”‚ â”‚ â””â”€ é€‰æ‹©3: path=[1,2,3] â†’ å®Œæ•´æ’åˆ— âœ…
â”‚ â””â”€ é€‰æ‹©3: path=[1,3], visited=[T,F,T]
â”‚ â””â”€ é€‰æ‹©2: path=[1,3,2] â†’ å®Œæ•´æ’åˆ— âœ…
â”œâ”€ é€‰æ‹©2: path=[2], visited=[F,T,F]
â”‚ â”œâ”€ é€‰æ‹©1: path=[2,1], visited=[T,T,F]
â”‚ â”‚ â””â”€ é€‰æ‹©3: path=[2,1,3] â†’ å®Œæ•´æ’åˆ— âœ…
â”‚ â””â”€ é€‰æ‹©3: path=[2,3], visited=[F,T,T]
â”‚ â””â”€ é€‰æ‹©1: path=[2,3,1] â†’ å®Œæ•´æ’åˆ— âœ…
â””â”€ é€‰æ‹©3: path=[3], visited=[F,F,T]
â”œâ”€ é€‰æ‹©1: path=[3,1], visited=[T,F,T]
â”‚ â””â”€ é€‰æ‹©2: path=[3,1,2] â†’ å®Œæ•´æ’åˆ— âœ…
â””â”€ é€‰æ‹©2: path=[3,2], visited=[F,T,T]
â””â”€ é€‰æ‹©1: path=[3,2,1] â†’ å®Œæ•´æ’åˆ— âœ…

```

---

## âœ… ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

**æ­£ç¡®æ€§åˆ†æï¼š**

1. **å®Œå¤‡æ€§**ï¼šç®—æ³•éå†äº†æ‰€æœ‰å¯èƒ½çš„é€‰æ‹©ç»„åˆ
   - æ¯ä¸ªä½ç½®éƒ½å°è¯•äº†æ‰€æœ‰æœªä½¿ç”¨çš„å…ƒç´ 
   - é€’å½’æ·±åº¦è¾¾åˆ°æ•°ç»„é•¿åº¦æ—¶åœæ­¢ï¼Œç¡®ä¿æ¯ä¸ªæ’åˆ—éƒ½æ˜¯å®Œæ•´çš„

2. **æ— é‡å¤æ€§**ï¼š
   - ä½¿ç”¨ `visited` æ•°ç»„ç¡®ä¿åŒä¸€å…ƒç´ åœ¨åŒä¸€æ’åˆ—ä¸­ä¸è¢«é‡å¤ä½¿ç”¨
   - é¢˜ç›®ä¿è¯è¾“å…¥æ— é‡å¤å…ƒç´ ï¼Œå› æ­¤ä¸åŒæ’åˆ—ä¹‹é—´ä¹Ÿä¸ä¼šé‡å¤

3. **è¾¹ç•Œå¤„ç†**ï¼š
   - ç©ºæ•°ç»„ï¼šä¸ä¼šè¿›å…¥å¾ªç¯ï¼Œç›´æ¥è¿”å›ç©ºç»“æœï¼ˆä½†é¢˜ç›®çº¦æŸé•¿åº¦â‰¥1ï¼‰
   - å•å…ƒç´ ï¼šç›´æ¥è¿”å›åŒ…å«è¯¥å…ƒç´ çš„å•ä¸€æ’åˆ—

**æ•°å­¦éªŒè¯ï¼š**
- å¯¹äº n ä¸ªä¸åŒå…ƒç´ ï¼Œå…¨æ’åˆ—æ•°é‡ä¸º n!
- ç®—æ³•ç”Ÿæˆçš„æ’åˆ—æ•°é‡ = n!ï¼Œä¸ç†è®ºå€¼ä¸€è‡´

---

## ğŸ“ˆ å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------------|------|
| å›æº¯ + visited | O(n Ã— n!) | O(n) | é€’å½’æ·±åº¦ä¸º nï¼Œæ¯å±‚æœ€å¤š n ä¸ªé€‰æ‹©ï¼›ç©ºé—´ä¸»è¦ä¸ºé€’å½’æ ˆå’Œ visited æ•°ç»„ |
| å›æº¯ + äº¤æ¢ | O(n Ã— n!) | O(n) | æ—¶é—´å¤æ‚åº¦ç›¸åŒï¼›ç©ºé—´å¤æ‚åº¦ç•¥ä¼˜ï¼Œæ— éœ€é¢å¤– visited æ•°ç»„ |

**è¯¦ç»†åˆ†æï¼š**
- **æ—¶é—´å¤æ‚åº¦**ï¼šå…±æœ‰ n! ä¸ªæ’åˆ—ï¼Œæ¯ä¸ªæ’åˆ—éœ€è¦ O(n) æ—¶é—´å¤åˆ¶åˆ°ç»“æœé›†ä¸­
- **ç©ºé—´å¤æ‚åº¦**ï¼š
  - é€’å½’æ ˆæ·±åº¦ï¼šO(n)
  - ç»“æœå­˜å‚¨ï¼šO(n Ã— n!)ï¼ˆä½†è¿™é€šå¸¸ä¸è®¡å…¥ç®—æ³•ç©ºé—´å¤æ‚åº¦ï¼‰
  - è¾…åŠ©ç©ºé—´ï¼švisited æ–¹æ³•éœ€è¦ O(n)ï¼Œäº¤æ¢æ–¹æ³•éœ€è¦ O(1)

---

## ğŸ“Œ é—®é¢˜æ€»ç»“

| è¦ç‚¹ | è¯´æ˜ |
|------|------|
| **æ ¸å¿ƒæ€æƒ³** | å›æº¯ç®—æ³• - é€‰æ‹©ã€é€’å½’ã€æ’¤é”€ |
| **å…³é”®æŠ€å·§** | ä½¿ç”¨ visited æ•°ç»„æˆ–åŸåœ°äº¤æ¢æ¥è·Ÿè¸ªå·²ä½¿ç”¨å…ƒç´  |
| **é€‚ç”¨åœºæ™¯** | æ’åˆ—ã€ç»„åˆã€å­é›†ç­‰æšä¸¾ç±»é—®é¢˜ |
| **æ³¨æ„äº‹é¡¹** | Go ä¸­åˆ‡ç‰‡å¼•ç”¨ä¼ é€’éœ€æ³¨æ„æ·±æ‹·è´ï¼›Java ä¸­ List éœ€è¦åˆ›å»ºæ–°å®ä¾‹ |
| **æ‰©å±•æ€è€ƒ** | è‹¥è¾“å…¥åŒ…å«é‡å¤å…ƒç´ ï¼Œéœ€è¦é¢å¤–å»é‡é€»è¾‘ï¼ˆå¦‚æ’åº+è·³è¿‡ç›¸é‚»é‡å¤ï¼‰ |

å…¨æ’åˆ—é—®é¢˜æ˜¯ç†è§£å›æº¯ç®—æ³•çš„ç»å…¸å…¥é—¨é¢˜ï¼ŒæŒæ¡å…¶è§£æ³•å¯¹è§£å†³æ›´å¤æ‚çš„ç»„åˆä¼˜åŒ–é—®é¢˜å…·æœ‰é‡è¦æ„ä¹‰ã€‚ä¸¤ç§å®ç°æ–¹å¼å„æœ‰ä¼˜åŠ¿ï¼švisited æ–¹æ³•é€»è¾‘æ›´ç›´è§‚ï¼Œäº¤æ¢æ–¹æ³•ç©ºé—´æ•ˆç‡æ›´é«˜ã€‚
