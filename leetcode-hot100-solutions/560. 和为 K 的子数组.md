# é—®é¢˜ç®€ä»‹

[LeetCode 560. å’Œä¸º K çš„å­æ•°ç»„](https://leetcode.cn/problems/subarray-sum-equals-k?envType=problem-list-v2&envId=2cktkvj)

## é¢˜ç›®æè¿°

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k`ï¼Œè¯·ä½ ç»Ÿè®¡å¹¶è¿”å› **è¯¥æ•°ç»„ä¸­å’Œä¸º `k` çš„è¿ç»­å­æ•°ç»„çš„ä¸ªæ•°**ã€‚

______________________________________________________________________

## ç¤ºä¾‹è¯´æ˜

âœ… **ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šnums = [1,1,1], k = 2
è¾“å‡ºï¼š2
è§£é‡Šï¼š[1,1] å‡ºç°äº†ä¸¤æ¬¡ï¼ˆä½ç½® [0,1] å’Œ [1,2]ï¼‰
```

âœ… **ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šnums = [1,2,3], k = 3
è¾“å‡ºï¼š2
è§£é‡Šï¼šå­æ•°ç»„ [1,2] å’Œ [3] çš„å’Œéƒ½ç­‰äº 3
```

âœ… **ç¤ºä¾‹ 3ï¼š**

```
è¾“å…¥ï¼šnums = [1], k = 0
è¾“å‡ºï¼š0
```

______________________________________________________________________

## è§£é¢˜æ€è·¯

### âŒ æš´åŠ›è§£æ³•ï¼ˆè¶…æ—¶ï¼‰

- æšä¸¾æ‰€æœ‰å­æ•°ç»„ `[i, j]`ï¼Œè®¡ç®—å…¶å’Œæ˜¯å¦ç­‰äº `k`
- æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²)
- ç©ºé—´å¤æ‚åº¦ï¼šO(1)
- **ä¸é€‚ç”¨äºå¤§æ•°ç»„ï¼ˆLeetCode ä¼šè¶…æ—¶ï¼‰**

### âœ… å‰ç¼€å’Œ + å“ˆå¸Œè¡¨ï¼ˆæœ€ä¼˜è§£ï¼‰

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³ï¼š**

> å¦‚æœ `prefixSum[j] - prefixSum[i] == k`ï¼Œé‚£ä¹ˆå­æ•°ç»„ `nums[i+1...j]` çš„å’Œå°±æ˜¯ `k`ã€‚

æ¢å¥è¯è¯´ï¼Œå¯¹äºå½“å‰å‰ç¼€å’Œ `sum`ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ä¹‹å‰æœ‰å¤šå°‘ä¸ªå‰ç¼€å’Œç­‰äº `sum - k`ã€‚

ğŸ“Œ **æ­¥éª¤å¦‚ä¸‹ï¼š**

1. åˆå§‹åŒ–å“ˆå¸Œè¡¨ `map`ï¼Œç”¨äºè®°å½•å‰ç¼€å’Œå‡ºç°çš„æ¬¡æ•°ã€‚
1. è®¾ç½® `map[0] = 1`ï¼Œè¡¨ç¤ºå‰ç¼€å’Œä¸º 0 å‡ºç°äº† 1 æ¬¡ï¼ˆç©ºæ•°ç»„ï¼‰ã€‚
1. éå†æ•°ç»„ï¼Œç»´æŠ¤å½“å‰å‰ç¼€å’Œ `sum`ã€‚
1. å¯¹äºæ¯ä¸ª `sum`ï¼Œæ£€æŸ¥ `map` ä¸­æ˜¯å¦å­˜åœ¨ `sum - k`ï¼š
   - å¦‚æœå­˜åœ¨ï¼Œè¯´æ˜æœ‰ `map[sum - k]` ä¸ªå­æ•°ç»„æ»¡è¶³æ¡ä»¶ï¼Œç´¯åŠ åˆ°ç»“æœã€‚
1. å°†å½“å‰ `sum` åŠ å…¥ `map`ï¼ˆæˆ–æ›´æ–°å…¶è®¡æ•°ï¼‰ã€‚

______________________________________________________________________

## ä»£ç å®ç°

```java
import java.util.*;

class Solution {
    public int subarraySum(int[] nums, int k) {
        Map<Integer, Integer> map = new HashMap<>();
        map.put(0, 1); // å‰ç¼€å’Œä¸º0å‡ºç°1æ¬¡ï¼ˆç©ºæ•°ç»„ï¼‰
        int sum = 0;
        int count = 0;

        for (int num : nums) {
            sum += num;
            if (map.containsKey(sum - k)) {
                count += map.get(sum - k);
            }
            map.put(sum, map.getOrDefault(sum, 0) + 1);
        }

        return count;
    }
}
```

```go
func subarraySum(nums []int, k int) int {
    prefixCount := make(map[int]int)
    prefixCount[0] = 1 // å‰ç¼€å’Œä¸º0å‡ºç°1æ¬¡ï¼ˆç©ºæ•°ç»„ï¼‰
    sum := 0
    count := 0

    for _, num := range nums {
        sum += num
        if val, exists := prefixCount[sum-k]; exists {
            count += val
        }
        prefixCount[sum]++
    }

    return count
}
```

______________________________________________________________________

## ç¤ºä¾‹æ¼”ç¤º

ä»¥ `nums = [1, 1, 1], k = 2` ä¸ºä¾‹ï¼š

| i | num | sum | sum - k | map before | count added | map after |
|---|-----|-----|---------|------------|-------------|-----------|
| 0 | 1 | 1 | -1 | {0:1} | 0 | {0:1,1:1} |
| 1 | 1 | 2 | 0 | {0:1,1:1} | +1 | {0:1,1:1,2:1} |
| 2 | 1 | 3 | 1 | {0:1,1:1,2:1} | +1 | {0:1,1:1,2:1,3:1} |

âœ… æœ€ç»ˆ `count = 2`

______________________________________________________________________

## ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

- **æ­£ç¡®æ€§**ï¼šåŸºäºå‰ç¼€å’Œæ€§è´¨ï¼Œè‹¥ `sum[j] - sum[i] = k`ï¼Œåˆ™å­æ•°ç»„ `nums[i+1...j]` å’Œä¸º `k`ã€‚
- **å®Œæ•´æ€§**ï¼šé€šè¿‡å“ˆå¸Œè¡¨è®°å½•æ‰€æœ‰å†å²å‰ç¼€å’Œï¼Œç¡®ä¿ä¸ä¼šé—æ¼ä»»ä½•å¯èƒ½çš„ `i`ã€‚
- **è¾¹ç•Œå¤„ç†**ï¼š`map[0] = 1` æ­£ç¡®å¤„ç†äº†ä»ç´¢å¼• 0 å¼€å§‹çš„å­æ•°ç»„ï¼ˆå¦‚ `[1,1]` åœ¨ç¤ºä¾‹1ä¸­ï¼‰ã€‚

______________________________________________________________________

## å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ |
|------|------------|------------|
| æš´åŠ›æšä¸¾ | O(nÂ²) | O(1) |
| å‰ç¼€å’Œ + å“ˆå¸Œè¡¨ | **O(n)** | **O(n)** |

âœ… **æœ€ä¼˜è§£ä¸º O(n) æ—¶é—´ + O(n) ç©ºé—´**

______________________________________________________________________

## é—®é¢˜æ€»ç»“

- ğŸ’¡ **å…³é”®æ´å¯Ÿ**ï¼šå°†â€œå­æ•°ç»„å’Œâ€é—®é¢˜è½¬åŒ–ä¸ºâ€œå‰ç¼€å’Œå·®å€¼â€é—®é¢˜ã€‚
- ğŸ“Œ **æŠ€å·§**ï¼šä½¿ç”¨å“ˆå¸Œè¡¨å¿«é€ŸæŸ¥æ‰¾å†å²å‰ç¼€å’Œï¼Œé¿å…é‡å¤è®¡ç®—ã€‚
- âœ… **é€‚ç”¨åœºæ™¯**ï¼šæ‰€æœ‰â€œè¿ç»­å­æ•°ç»„å’Œä¸ºæŸå€¼â€çš„è®¡æ•°é—®é¢˜å‡å¯å¥—ç”¨æ­¤æ¨¡æ¿ã€‚
- ğŸ” **æ‰©å±•æ€è€ƒ**ï¼šè‹¥è¦æ±‚å­æ•°ç»„é•¿åº¦é™åˆ¶ã€æˆ–æ±‚æœ€å¤§é•¿åº¦ç­‰ï¼Œå¯åœ¨æ­¤åŸºç¡€ä¸Šè°ƒæ•´ã€‚
