# é—®é¢˜ç®€ä»‹

[LeetCode 581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„](https://leetcode.cn/problems/shortest-unsorted-continuous-subarray?envType=problem-list-v2&envId=2cktkvj)

## é¢˜ç›®æè¿°

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums`ï¼Œä½ éœ€è¦æ‰¾å‡ºä¸€ä¸ª**æœ€çŸ­çš„è¿ç»­å­æ•°ç»„**ï¼Œä½¿å¾—å¯¹è¯¥å­æ•°ç»„è¿›è¡Œå‡åºæ’åºåï¼Œæ•´ä¸ªæ•°ç»„éƒ½ä¼šå˜ä¸ºå‡åºã€‚è¿”å›è¯¥å­æ•°ç»„çš„é•¿åº¦ã€‚

å¦‚æœåŸæ•°ç»„å·²ç»æ˜¯å‡åºæ’åˆ—ï¼Œåˆ™è¿”å› `0`ã€‚

______________________________________________________________________

# ç¤ºä¾‹è¯´æ˜

âœ… **ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šnums = [2,6,4,8,10,9,15]
è¾“å‡ºï¼š5
è§£é‡Šï¼šä½ åªéœ€è¦å¯¹ [6, 4, 8, 10, 9] è¿›è¡Œå‡åºæ’åºï¼Œé‚£ä¹ˆæ•´ä¸ªæ•°ç»„éƒ½ä¼šå˜ä¸ºå‡åºã€‚
```

âœ… **ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šnums = [1,2,3,4]
è¾“å‡ºï¼š0
è§£é‡Šï¼šæ•°ç»„å·²ç»æ˜¯å‡åºã€‚
```

âœ… **ç¤ºä¾‹ 3ï¼š**

```
è¾“å…¥ï¼šnums = [1]
è¾“å‡ºï¼š0
```

______________________________________________________________________

# è§£é¢˜æ€è·¯

ğŸ“Œ **æ ¸å¿ƒæ€æƒ³**ï¼š\
æˆ‘ä»¬è¦æ‰¾åˆ°æœ€çŸ­çš„è¿ç»­å­æ•°ç»„ `[left, right]`ï¼Œä½¿å¾—ï¼š

- å­æ•°ç»„å·¦è¾¹çš„æ‰€æœ‰å…ƒç´  â‰¤ å­æ•°ç»„ä¸­çš„æœ€å°å€¼ï¼›
- å­æ•°ç»„å³è¾¹çš„æ‰€æœ‰å…ƒç´  â‰¥ å­æ•°ç»„ä¸­çš„æœ€å¤§å€¼ï¼›
- å¹¶ä¸”æ•´ä¸ªæ•°ç»„åœ¨æ’åºè¯¥å­æ•°ç»„åå˜ä¸ºå®Œå…¨å‡åºã€‚

______________________________________________________________________

## âœ… æ–¹æ³•ä¸€ï¼šä¸¤æ¬¡éå†ï¼ˆæ¨èï¼‰

### æ­¥éª¤è¯¦è§£ï¼š

1. **ä»å·¦å‘å³æ‰«æ**ï¼Œæ‰¾åˆ°æœ€åä¸€ä¸ªâ€œç ´åå‡åºâ€çš„ä½ç½®ï¼ˆå³ `nums[i] < nums[i-1]`ï¼‰ï¼Œå¹¶è®°å½•è¯¥ä½ç½®ä¸º `right`ã€‚

   - åŒæ—¶ç»´æŠ¤åˆ°å½“å‰ä½ç½®ä¸ºæ­¢çš„æœ€å¤§å€¼ `maxSoFar`ã€‚
   - å¦‚æœ `nums[i] < maxSoFar`ï¼Œè¯´æ˜å½“å‰ä½ç½®éœ€è¦è¢«åŒ…å«åœ¨å¾…æ’åºå­æ•°ç»„ä¸­ï¼Œæ›´æ–° `right = i`ã€‚

1. **ä»å³å‘å·¦æ‰«æ**ï¼Œæ‰¾åˆ°æœ€åä¸€ä¸ªâ€œç ´åé™åºâ€ï¼ˆä»å³çœ‹æ˜¯å‡åºï¼‰çš„ä½ç½®ï¼Œè®°å½•ä¸º `left`ã€‚

   - ç»´æŠ¤åˆ°å½“å‰ä½ç½®ä¸ºæ­¢çš„æœ€å°å€¼ `minSoFar`ã€‚
   - å¦‚æœ `nums[i] > minSoFar`ï¼Œè¯´æ˜å½“å‰ä½ç½®éœ€è¦è¢«åŒ…å«ï¼Œæ›´æ–° `left = i`ã€‚

1. æœ€ç»ˆç»“æœä¸º `right - left + 1`ã€‚è‹¥ `right < left`ï¼ˆå³æœªæ‰¾åˆ°ï¼‰ï¼Œè¿”å› 0ã€‚

ğŸ’¡ **ä¸ºä»€ä¹ˆè¿™æ ·æœ‰æ•ˆï¼Ÿ**

- `right` æ˜¯æœ€å³çš„ã€æ¯”å‰é¢æœ€å¤§å€¼è¿˜å°çš„å…ƒç´  â†’ å®ƒå¿…é¡»è¢«é‡æ’ã€‚
- `left` æ˜¯æœ€å·¦çš„ã€æ¯”åé¢æœ€å°å€¼è¿˜å¤§çš„å…ƒç´  â†’ å®ƒä¹Ÿå¿…é¡»è¢«é‡æ’ã€‚
- ä¸­é—´æ‰€æœ‰å…ƒç´ è‡ªç„¶ä¹Ÿè¦åŒ…å«è¿›æ¥ã€‚

______________________________________________________________________

## âœ… æ–¹æ³•äºŒï¼šæ’åºæ¯”è¾ƒæ³•ï¼ˆç›´è§‚ä½†ç©ºé—´é«˜ï¼‰

1. å¤åˆ¶åŸæ•°ç»„å¹¶æ’åºå¾—åˆ° `sortedNums`ã€‚
1. ä»å·¦æ‰¾ç¬¬ä¸€ä¸ª `nums[i] != sortedNums[i]` â†’ `left`ã€‚
1. ä»å³æ‰¾ç¬¬ä¸€ä¸ª `nums[j] != sortedNums[j]` â†’ `right`ã€‚
1. è¿”å› `right - left + 1`ï¼ˆè‹¥æ²¡æ‰¾åˆ°åˆ™ä¸º 0ï¼‰ã€‚

âŒ ç¼ºç‚¹ï¼šéœ€è¦ O(n) é¢å¤–ç©ºé—´ï¼Œä¸”æ—¶é—´å¤æ‚åº¦ O(n log n)ã€‚

______________________________________________________________________

## âœ… æ–¹æ³•ä¸‰ï¼šå•è°ƒæ ˆï¼ˆè¿›é˜¶ï¼‰

ä½¿ç”¨å•è°ƒé€’å¢æ ˆæ‰¾æ¯ä¸ªå…ƒç´ å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„ä½ç½®ï¼ˆç¡®å®šå·¦è¾¹ç•Œï¼‰ï¼Œä»¥åŠå³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„ä½ç½®ï¼ˆç¡®å®šå³è¾¹ç•Œï¼‰ã€‚æœ€ç»ˆå–æœ€å·¦å’Œæœ€å³ã€‚

ä½†å®ç°è¾ƒå¤æ‚ï¼Œä¸å¦‚æ–¹æ³•ä¸€ç®€æ´ã€‚

______________________________________________________________________

# ä»£ç å®ç°

<div class="code-tabs">

```java:Java
class Solution {
    public int findUnsortedSubarray(int[] nums) {
        int n = nums.length;
        int maxSoFar = nums[0];
        int minSoFar = nums[n - 1];
        int left = n, right = -1;

        // ä»å·¦åˆ°å³æ‰¾ right
        for (int i = 1; i < n; i++) {
            if (nums[i] < maxSoFar) {
                right = i;
            } else {
                maxSoFar = nums[i];
            }
        }

        // ä»å³åˆ°å·¦æ‰¾ left
        for (int i = n - 2; i >= 0; i--) {
            if (nums[i] > minSoFar) {
                left = i;
            } else {
                minSoFar = nums[i];
            }
        }

        return right == -1 ? 0 : right - left + 1;
    }
}
```

```go:Go
func findUnsortedSubarray(nums []int) int {
    n := len(nums)
    maxSoFar := nums[0]
    minSoFar := nums[n-1]
    left, right := n, -1

    // ä»å·¦åˆ°å³æ‰¾ right
    for i := 1; i < n; i++ {
        if nums[i] < maxSoFar {
            right = i
        } else {
            maxSoFar = nums[i]
        }
    }

    // ä»å³åˆ°å·¦æ‰¾ left
    for i := n - 2; i >= 0; i-- {
        if nums[i] > minSoFar {
            left = i
        } else {
            minSoFar = nums[i]
        }
    }

    if right == -1 {
        return 0
    }
    return right - left + 1
}
```

</div>

______________________________________________________________________

# ç¤ºä¾‹æ¼”ç¤º

ä»¥ `nums = [2,6,4,8,10,9,15]` ä¸ºä¾‹ï¼š

| i | nums[i] | maxSoFar | right æ›´æ–°ï¼Ÿ | minSoFarï¼ˆåå‘ï¼‰ | left æ›´æ–°ï¼Ÿ |
|---|--------|----------|-------------|------------------|------------|
| 0 | 2 | 2 | - | - | - |
| 1 | 6 | 6 | å¦ | - | - |
| 2 | 4 | 6 | âœ… right=2 | - | - |
| 3 | 8 | 8 | å¦ | - | - |
| 4 |10 |10 | å¦ | - | - |
| 5 | 9 |10 | âœ… right=5 | - | - |
| 6 |15 |15 | å¦ | - | - |

åå‘æ‰«æï¼š

| i | nums[i] | minSoFar | left æ›´æ–°ï¼Ÿ |
|---|--------|----------|------------|
| 6 |15 |15 | - |
| 5 |9 |9 | - |
| 4 |10 |9 | âœ… left=4 |
| 3 |8 |8 | - |
| 2 |4 |4 | - |
| 1 |6 |4 | âœ… left=1 |
| 0 |2 |2 | - |

â†’ `left = 1`, `right = 5` â†’ é•¿åº¦ = 5 âœ…

______________________________________________________________________

# ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

âœ… **æ­£ç¡®æ€§ä¾æ®**ï¼š

- è‹¥å­˜åœ¨æ— åºå­æ•°ç»„ï¼Œåˆ™å…¶**å·¦è¾¹ç•Œ**å¿…ç„¶æ˜¯æŸä¸ªå…ƒç´ å¤§äºå…¶å³ä¾§æŸå…ƒç´ çš„æœ€å·¦ä½ç½®ï¼›
- å…¶**å³è¾¹ç•Œ**å¿…ç„¶æ˜¯æŸä¸ªå…ƒç´ å°äºå…¶å·¦ä¾§æŸå…ƒç´ çš„æœ€å³ä½ç½®ï¼›
- æ–¹æ³•ä¸€é€šè¿‡ç»´æŠ¤å‰ç¼€æœ€å¤§å€¼å’Œåç¼€æœ€å°å€¼ï¼Œç²¾ç¡®æ•è·äº†è¿™ä¸¤ä¸ªè¾¹ç•Œï¼›
- æ‰€æœ‰ä¸­é—´å…ƒç´ è‡ªåŠ¨è¢«åŒ…å«ï¼Œå› ä¸ºä¸€æ—¦å·¦å³è¾¹ç•Œç¡®å®šï¼Œä¸­é—´æ— è®ºæ˜¯å¦â€œå±€éƒ¨æœ‰åºâ€ï¼Œæ•´ä½“ä»éœ€æ’åºæ‰èƒ½ä½¿å…¨å±€æœ‰åºã€‚

ğŸ“Œ **è¾¹ç•Œæƒ…å†µè¦†ç›–**ï¼š

- å…¨å‡åº â†’ `right` å§‹ç»ˆä¸º -1 â†’ è¿”å› 0ï¼›
- å•å…ƒç´  â†’ åŒä¸Šï¼›
- å…¨é™åº â†’ `left=0`, `right=n-1` â†’ è¿”å› nã€‚

______________________________________________________________________

# å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | è¯„ä»· |
|------|-----------|-----------|------|
| ä¸¤æ¬¡éå†ï¼ˆæ–¹æ³•ä¸€ï¼‰ | **O(n)** | **O(1)** | âœ… æœ€ä¼˜è§£ |
| æ’åºæ¯”è¾ƒï¼ˆæ–¹æ³•äºŒï¼‰ | O(n log n) | O(n) | âŒ æ¬¡ä¼˜ |
| å•è°ƒæ ˆï¼ˆæ–¹æ³•ä¸‰ï¼‰ | O(n) | O(n) | âš ï¸ å¯è¡Œä½†ä¸ç®€æ´ |

______________________________________________________________________

# é—®é¢˜æ€»ç»“

âœ… **å…³é”®æ´å¯Ÿ**ï¼š

> ä¸éœ€è¦çŸ¥é“å­æ•°ç»„å†…éƒ¨å¦‚ä½•æ’åºï¼Œåªéœ€ç¡®å®š**å¿…é¡»è¢«é‡æ’çš„æœ€å·¦å’Œæœ€å³ä½ç½®**ã€‚

âœ… **æŠ€å·§æç‚¼**ï¼š

- åˆ©ç”¨ **å‰ç¼€æœ€å¤§å€¼** å’Œ **åç¼€æœ€å°å€¼** å¿«é€Ÿå®šä½è¾¹ç•Œï¼›
- é¿å…å®é™…æ’åºï¼Œå®ç°çº¿æ€§æ—¶é—´å’Œå¸¸æ•°ç©ºé—´ã€‚

ğŸ’¡ **é€‚ç”¨åœºæ™¯**ï¼š\
æ­¤ç±»â€œå±€éƒ¨æ— åºå½±å“å…¨å±€æœ‰åºâ€çš„é—®é¢˜ï¼Œå¸¸å¯é€šè¿‡**è¾¹ç•Œæ¢æµ‹ + æå€¼ç»´æŠ¤**é«˜æ•ˆè§£å†³ã€‚

ğŸ“Œ **ä¸€å¥è¯æ€»ç»“**ï¼š

> æ‰¾å‡ºâ€œä¸è¯¥å‡ºç°åœ¨è¿™é‡Œâ€çš„æœ€å·¦å’Œæœ€å³å…ƒç´ ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºé—´å°±æ˜¯ç­”æ¡ˆã€‚
