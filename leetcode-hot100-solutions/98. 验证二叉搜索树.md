# éªŒè¯äºŒå‰æœç´¢æ ‘ï¼ˆLeetCode 98ï¼‰

ğŸ“Œ **[é¢˜ç›®é“¾æ¥](https://leetcode.cn/problems/validate-binary-search-tree?envType=problem-list-v2&envId=2cktkvj)**

## â“ é—®é¢˜ç®€ä»‹

ç»™ä½ ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ `root`ï¼Œåˆ¤æ–­å…¶æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰ã€‚

**æœ‰æ•ˆäºŒå‰æœç´¢æ ‘å®šä¹‰ä¸ºï¼š**

- èŠ‚ç‚¹çš„å·¦å­æ ‘åªåŒ…å«å°äºå½“å‰èŠ‚ç‚¹çš„æ•°ã€‚
- èŠ‚ç‚¹çš„å³å­æ ‘åªåŒ…å«å¤§äºå½“å‰èŠ‚ç‚¹çš„æ•°ã€‚
- æ‰€æœ‰å·¦å­æ ‘å’Œå³å­æ ‘è‡ªèº«ä¹Ÿå¿…é¡»æ˜¯äºŒå‰æœç´¢æ ‘ã€‚

> æ³¨æ„ï¼š**ä¸èƒ½åªæ¯”è¾ƒå½“å‰èŠ‚ç‚¹ä¸å…¶å·¦å³å­èŠ‚ç‚¹çš„å¤§å°å…³ç³»**ï¼Œå› ä¸º BST çš„æ€§è´¨è¦æ±‚çš„æ˜¯**æ•´ä¸ªå·¦å­æ ‘éƒ½å°äºå½“å‰èŠ‚ç‚¹ï¼Œæ•´ä¸ªå³å­æ ‘éƒ½å¤§äºå½“å‰èŠ‚ç‚¹**ã€‚

______________________________________________________________________

## ğŸ§ª ç¤ºä¾‹è¯´æ˜

### ç¤ºä¾‹ 1ï¼š

```
è¾“å…¥ï¼šroot = [2,1,3]
è¾“å‡ºï¼štrue
```

âœ… è§£é‡Šï¼šæ»¡è¶³ BST å®šä¹‰ã€‚

### ç¤ºä¾‹ 2ï¼š

```
è¾“å…¥ï¼šroot = [5,1,4,null,null,3,6]
è¾“å‡ºï¼šfalse
```

âŒ è§£é‡Šï¼šæ ¹èŠ‚ç‚¹ä¸º 5ï¼Œå…¶å³å­èŠ‚ç‚¹ä¸º 4ï¼Œè™½ç„¶ 4 > 5 ä¸æˆç«‹ï¼ˆå®é™… 4 < 5ï¼‰ï¼Œä½†æ›´å…³é”®çš„æ˜¯ï¼šå³å­æ ‘ä¸­çš„ 3 å°äºæ ¹èŠ‚ç‚¹ 5ï¼Œè¿åäº† BST æ€§è´¨ã€‚

### ç¤ºä¾‹ 3ï¼ˆæ˜“é”™ï¼‰ï¼š

```
è¾“å…¥ï¼šroot = [5,4,6,null,null,3,7]
è¾“å‡ºï¼šfalse
```

âŒ è§£é‡Šï¼šè™½ç„¶æ¯ä¸ªçˆ¶å­èŠ‚ç‚¹çœ‹èµ·æ¥åˆæ³•ï¼ˆ4\<5\<6ï¼Œ3\<6\<7ï¼‰ï¼Œä½†å³å­æ ‘ä¸­çš„ 3 å°äºæ ¹èŠ‚ç‚¹ 5ï¼Œè¿å BST å…¨å±€æ€§è´¨ã€‚

______________________________________________________________________

## ğŸ’¡ è§£é¢˜æ€è·¯

### âœ… æ–¹æ³•ä¸€ï¼šä¸­åºéå†ï¼ˆæ¨èï¼‰

**æ ¸å¿ƒæ€æƒ³**ï¼š\
BST çš„ä¸­åºéå†ç»“æœæ˜¯ä¸€ä¸ª**ä¸¥æ ¼é€’å¢**çš„åºåˆ—ã€‚

**æ­¥éª¤**ï¼š

1. å¯¹æ ‘è¿›è¡Œä¸­åºéå†ï¼ˆå·¦ â†’ æ ¹ â†’ å³ï¼‰ã€‚
1. è®°å½•ä¸Šä¸€ä¸ªè®¿é—®çš„èŠ‚ç‚¹å€¼ `prev`ã€‚
1. å¦‚æœå½“å‰èŠ‚ç‚¹å€¼ â‰¤ `prev`ï¼Œåˆ™ä¸æ˜¯ BSTã€‚
1. å¦åˆ™æ›´æ–° `prev`ï¼Œç»§ç»­éå†ã€‚

> âš ï¸ æ³¨æ„ï¼šå¿…é¡»æ˜¯**ä¸¥æ ¼é€’å¢**ï¼Œå³ä¸èƒ½æœ‰ç›¸ç­‰å…ƒç´ ï¼ˆé¢˜ç›®éšå«æ¡ä»¶ï¼‰ã€‚

______________________________________________________________________

### âœ… æ–¹æ³•äºŒï¼šé€’å½’ + ä¸Šä¸‹ç•Œçº¦æŸ

**æ ¸å¿ƒæ€æƒ³**ï¼š\
æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªåˆæ³•çš„å–å€¼èŒƒå›´ `(min, max)`ã€‚

**æ­¥éª¤**ï¼š

1. åˆå§‹æ—¶ï¼Œæ ¹èŠ‚ç‚¹çš„èŒƒå›´æ˜¯ `(-âˆ, +âˆ)`ã€‚
1. é€’å½’å·¦å­æ ‘æ—¶ï¼Œä¸Šé™å˜ä¸ºå½“å‰èŠ‚ç‚¹å€¼ã€‚
1. é€’å½’å³å­æ ‘æ—¶ï¼Œä¸‹é™å˜ä¸ºå½“å‰èŠ‚ç‚¹å€¼ã€‚
1. è‹¥å½“å‰èŠ‚ç‚¹å€¼ä¸åœ¨ `(min, max)` èŒƒå›´å†…ï¼Œåˆ™éæ³•ã€‚

> ä½¿ç”¨ `Long.MIN_VALUE` å’Œ `Long.MAX_VALUE` é¿å…æ•´æ•°æº¢å‡ºè¾¹ç•Œé—®é¢˜ã€‚

______________________________________________________________________

### âœ… æ–¹æ³•ä¸‰ï¼šè¿­ä»£ä¸­åºéå†ï¼ˆéé€’å½’ï¼‰

ä¸æ–¹æ³•ä¸€é€»è¾‘ç›¸åŒï¼Œä½†ä½¿ç”¨æ ˆæ‰‹åŠ¨æ¨¡æ‹Ÿé€’å½’è¿‡ç¨‹ï¼Œé¿å…å‡½æ•°è°ƒç”¨æ ˆæº¢å‡ºï¼ˆå¯¹ææ·±æ ‘æ›´å®‰å…¨ï¼‰ã€‚

______________________________________________________________________

## ğŸ’» ä»£ç å®ç°

<div class="code-tabs">

```java:Java
// æ–¹æ³•ä¸€ï¼šä¸­åºéå†ï¼ˆé€’å½’ï¼‰
class Solution {
    private Long prev = null; // ä½¿ç”¨ Long é¿å…åˆå§‹å€¼å¹²æ‰°

    public boolean isValidBST(TreeNode root) {
        if (root == null) return true;
        
        // å·¦å­æ ‘
        if (!isValidBST(root.left)) return false;
        
        // å½“å‰èŠ‚ç‚¹
        if (prev != null && root.val <= prev) return false;
        prev = (long) root.val;
        
        // å³å­æ ‘
        return isValidBST(root.right);
    }
}

// æ–¹æ³•äºŒï¼šä¸Šä¸‹ç•Œçº¦æŸï¼ˆé€’å½’ï¼‰
class Solution {
    public boolean isValidBST(TreeNode root) {
        return validate(root, Long.MIN_VALUE, Long.MAX_VALUE);
    }
    
    private boolean validate(TreeNode node, long min, long max) {
        if (node == null) return true;
        if (node.val <= min || node.val >= max) return false;
        
        return validate(node.left, min, node.val) && 
               validate(node.right, node.val, max);
    }
}
```

```go:Go
// æ–¹æ³•ä¸€ï¼šä¸­åºéå†ï¼ˆé€’å½’ï¼‰
func isValidBST(root *TreeNode) bool {
    var prev *int
    var inorder func(*TreeNode) bool
    inorder = func(node *TreeNode) bool {
        if node == nil {
            return true
        }
        if !inorder(node.Left) {
            return false
        }
        if prev != nil && *prev >= node.Val {
            return false
        }
        prev = &node.Val
        return inorder(node.Right)
    }
    return inorder(root)
}

// æ–¹æ³•äºŒï¼šä¸Šä¸‹ç•Œçº¦æŸï¼ˆé€’å½’ï¼‰
func isValidBST(root *TreeNode) bool {
    return validate(root, math.MinInt64, math.MaxInt64)
}

func validate(node *TreeNode, min, max int64) bool {
    if node == nil {
        return true
    }
    if int64(node.Val) <= min || int64(node.Val) >= max {
        return false
    }
    return validate(node.Left, min, int64(node.Val)) &&
           validate(node.Right, int64(node.Val), max)
}
```

</div>

______________________________________________________________________

## ğŸ¯ ç¤ºä¾‹æ¼”ç¤º

ä»¥ `root = [5,1,4,null,null,3,6]` ä¸ºä¾‹ï¼š

### ä¸­åºéå†è¿‡ç¨‹ï¼š

- éå†é¡ºåºï¼š1 â†’ 5 â†’ 3 â†’ 4 â†’ 6
- æ£€æŸ¥åºåˆ—ï¼š`[1, 5, 3, ...]`
- å‘ç° `3 < 5`ï¼ˆä¸æ»¡è¶³é€’å¢ï¼‰â†’ è¿”å› `false`

### ä¸Šä¸‹ç•Œçº¦æŸè¿‡ç¨‹ï¼š

- æ ¹èŠ‚ç‚¹ 5ï¼šèŒƒå›´ `(-âˆ, +âˆ)` âœ…
- å·¦å­ 1ï¼šèŒƒå›´ `(-âˆ, 5)` âœ…
- å³å­ 4ï¼šèŒƒå›´ `(5, +âˆ)` âŒï¼ˆ4 < 5ï¼‰â†’ ç›´æ¥è¿”å› `false`

> å®é™…ä¸Šï¼Œç¤ºä¾‹ 2 åœ¨ä¸Šä¸‹ç•Œæ–¹æ³•ä¸­ä¼šåœ¨æ£€æŸ¥èŠ‚ç‚¹ 4 æ—¶å°±å¤±è´¥ï¼Œæ•ˆç‡æ›´é«˜ã€‚

______________________________________________________________________

## âœ… ç­”æ¡ˆæœ‰æ•ˆæ€§è¯æ˜

| æ–¹æ³• | æ­£ç¡®æ€§ä¾æ® |
|------|-----------|
| ä¸­åºéå† | **å……è¦æ¡ä»¶**ï¼šä¸€æ£µäºŒå‰æ ‘æ˜¯ BST â‡” å…¶ä¸­åºéå†ä¸ºä¸¥æ ¼é€’å¢åºåˆ— |
| ä¸Šä¸‹ç•Œçº¦æŸ | **æ•°å­¦å½’çº³æ³•**ï¼šè‹¥æ¯ä¸ªèŠ‚ç‚¹éƒ½åœ¨å…¶åˆæ³•åŒºé—´å†…ï¼Œä¸”å­æ ‘é€’å½’æ»¡è¶³ï¼Œåˆ™æ•´æ£µæ ‘ä¸º BST |

> ä¸¤ç§æ–¹æ³•å‡èƒ½è¦†ç›–æ‰€æœ‰è¾¹ç•Œæƒ…å†µï¼ŒåŒ…æ‹¬ï¼š
>
> - ç©ºæ ‘ï¼ˆè¿”å› trueï¼‰
> - å•èŠ‚ç‚¹æ ‘ï¼ˆè¿”å› trueï¼‰
> - åŒ…å« `Integer.MIN_VALUE` / `MAX_VALUE` çš„æ ‘ï¼ˆä½¿ç”¨ long é¿å…è¾¹ç•Œé”™è¯¯ï¼‰

______________________________________________________________________

## ğŸ“Š å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | è¯´æ˜ |
|------|------------|------------|------|
| ä¸­åºéå†ï¼ˆé€’å½’ï¼‰ | O(n) | O(h) | h ä¸ºæ ‘é«˜ï¼Œæœ€å O(n)ï¼ˆé€€åŒ–ä¸ºé“¾è¡¨ï¼‰ |
| ä¸Šä¸‹ç•Œçº¦æŸ | O(n) | O(h) | åŒä¸Š |
| ä¸­åºéå†ï¼ˆè¿­ä»£ï¼‰ | O(n) | O(h) | æ˜¾å¼æ ˆç©ºé—´ |

> æ‰€æœ‰æ–¹æ³•éƒ½éœ€è¦è®¿é—®æ¯ä¸ªèŠ‚ç‚¹ä¸€æ¬¡ï¼Œæ•…æ—¶é—´å¤æ‚åº¦å‡ä¸º O(n)ã€‚

______________________________________________________________________

## ğŸ”š é—®é¢˜æ€»ç»“

- **å…³é”®é™·é˜±**ï¼šä¸èƒ½ä»…æ¯”è¾ƒçˆ¶å­èŠ‚ç‚¹ï¼Œå¿…é¡»ä¿è¯**å…¨å±€æœ‰åºæ€§**ã€‚
- **æœ€ä¼˜è§£é€‰æ‹©**ï¼š
  - **ä¸­åºéå†**ï¼šç›´è§‚ã€æ˜“ç†è§£ï¼Œé€‚åˆé¢è¯•å¿«é€Ÿå®ç°ã€‚
  - **ä¸Šä¸‹ç•Œçº¦æŸ**ï¼šæå‰å‰ªæï¼ˆå¦‚ç¤ºä¾‹ 2 å¯åœ¨ç¬¬äºŒå±‚å°±è¿”å› falseï¼‰ï¼Œå®é™…è¿è¡Œå¯èƒ½æ›´å¿«ã€‚
- **è¾¹ç•Œå¤„ç†**ï¼šåŠ¡å¿…ä½¿ç”¨ `long` æˆ– `int64` é¿å…æ•´æ•°è¾¹ç•Œå€¼å¯¼è‡´çš„é”™è¯¯ã€‚
- **æ‰©å±•æ€è€ƒ**ï¼šè‹¥å…è®¸é‡å¤å€¼ï¼ˆå³â€œéä¸¥æ ¼ BSTâ€ï¼‰ï¼Œåªéœ€å°†æ¯”è¾ƒç¬¦ `<=` æ”¹ä¸º `<` å³å¯ã€‚
